(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[817],{1195:function(t,e,r){"use strict";var n=r(3203);e.Z=void 0;var s=n(r(9124)),i=r(4246),o=(0,s.default)((0,i.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert");e.Z=o},1589:function(t,e,r){"use strict";var n=r(3203);e.Z=void 0;var s=n(r(9124)),i=r(4246),o=(0,s.default)((0,i.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");e.Z=o},8355:function(t,e,r){"use strict";r.d(e,{M:function(){return a}});var n=r(6331),s=r(4460),i=r(6419);r(9382);class o{constructor({enumerate:t,seed:e}){this.enumerateFn=t,this.seed=e,this.iterationCounter=0,this._opts={}}addOpt({key:t,range:e,initial:r}){this._opts[t]={range:e,value:r}}getOpt(t){return this._opts[t].value}setOpt(t,e){t in this._opts&&(this._opts[t].value=e)}opts(){return this._opts}enumerate(t,e,r){return this.enumerateFn(t,e,r).map((t=>"payload"in t?t:"move"in t?(0,n.B)(t.move,t.args,r):"event"in t?(0,n.g)(t.event,t.args,r):void 0))}random(t){let e;if(void 0!==this.seed){const t=this.prngstate?"":this.seed,r=(0,s.a)(t,this.prngstate);e=r(),this.prngstate=r.state()}else e=Math.random();if(t){if(Array.isArray(t)){return t[Math.floor(e*t.length)]}return Math.floor(e*t)}return e}}class a extends o{constructor({enumerate:t,seed:e,objectives:r,game:n,iterations:s,playoutDepth:o,iterationCallback:a}){super({enumerate:t,seed:e}),void 0===r&&(r=()=>({})),this.objectives=r,this.iterationCallback=a||(()=>{}),this.reducer=(0,i.C)({game:n}),this.iterations=s,this.playoutDepth=o,this.addOpt({key:"async",initial:!1}),this.addOpt({key:"iterations",initial:"number"===typeof s?s:1e3,range:{min:1,max:2e3}}),this.addOpt({key:"playoutDepth",initial:"number"===typeof o?o:50,range:{min:1,max:100}})}createNode({state:t,parentAction:e,parent:r,playerID:n}){const{G:s,ctx:i}=t;let o=[],a=[];if(void 0!==n)o=this.enumerate(s,i,n),a=this.objectives(s,i,n);else if(i.activePlayers)for(const c in i.activePlayers)o.push(...this.enumerate(s,i,c)),a.push(this.objectives(s,i,c));else o=this.enumerate(s,i,i.currentPlayer),a=this.objectives(s,i,i.currentPlayer);return{state:t,parent:r,parentAction:e,actions:o,objectives:a,children:[],visits:0,value:0}}select(t){if(t.actions.length>0)return t;if(0===t.children.length)return t;let e=null,r=0;for(const n of t.children){const s=n.visits+Number.EPSILON,i=n.value/s+Math.sqrt(2*Math.log(t.visits)/s);(null==e||i>r)&&(r=i,e=n)}return this.select(e)}expand(t){const e=t.actions;if(0===e.length||void 0!==t.state.ctx.gameover)return t;const r=this.random(e.length),n=e[r];t.actions.splice(r,1);const s=this.reducer(t.state,n),i=this.createNode({state:s,parentAction:n,parent:t});return t.children.push(i),i}playout({state:t}){let e=this.getOpt("playoutDepth");"function"===typeof this.playoutDepth&&(e=this.playoutDepth(t.G,t.ctx));for(let r=0;r<e&&void 0===t.ctx.gameover;r++){const{G:e,ctx:r}=t;let n=r.currentPlayer;r.activePlayers&&(n=Object.keys(r.activePlayers)[0]);const s=this.enumerate(e,r,n),i=this.objectives(e,r,n),o=Object.keys(i).reduce(((t,n)=>{const s=i[n];return s.checker(e,r)?t+s.weight:t}),0);if(o>0)return{score:o};if(!s||0===s.length)return;const a=this.random(s.length);t=this.reducer(t,s[a])}return t.ctx.gameover}backpropagate(t,e={}){t.visits++,void 0!==e.score&&(t.value+=e.score),!0===e.draw&&(t.value+=.5),t.parentAction&&e.winner===t.parentAction.payload.playerID&&t.value++,t.parent&&this.backpropagate(t.parent,e)}play(t,e){const r=this.createNode({state:t,playerID:e});let n=this.getOpt("iterations");"function"===typeof this.iterations&&(n=this.iterations(t.G,t.ctx));const s=()=>{let t=null;for(const e of r.children)(null==t||e.visits>t.visits)&&(t=e);return{action:t&&t.parentAction,metadata:r}};return new Promise((t=>{const e=()=>{for(let t=0;t<25&&this.iterationCounter<n;t++){const t=this.select(r),e=this.expand(t),n=this.playout(e);this.backpropagate(e,n),this.iterationCounter++}this.iterationCallback({iterationCounter:this.iterationCounter,numIterations:n,metadata:r})};if(this.iterationCounter=0,this.getOpt("async")){const r=()=>{this.iterationCounter<n?(e(),setImmediate(r)):t(s())};r()}else{for(;this.iterationCounter<n;)e();t(s())}}))}}},1003:function(t,e,r){"use strict";r.d(e,{I:function(){return i}});var n=r(6331),s=r(6419);function i({game:t,numPlayers:e,setupData:r}){e||(e=2);let i={G:{},ctx:(t=(0,s.P)(t)).flow.ctx(e),plugins:{}};i=(0,n.t)(i,{game:t}),i=(0,n.m)(i,{game:t,playerID:void 0});const o=(0,n.E)(i);i.G=t.setup(o,r);let a={...i,_undo:[],_redo:[],_stateID:0};return a=t.flow.init(a),[a]=(0,n.q)(a,{game:t}),t.disableUndo||(a._undo=[{G:a.G,ctx:a.ctx,plugins:a.plugins}]),a}},4460:function(t,e,r){"use strict";r.d(e,{R:function(){return a},a:function(){return i}});class n{constructor(t){const e=function(){let t=4022871197;return function(e){const r=e.toString();for(let n=0;n<r.length;n++){t+=r.charCodeAt(n);let e=.02519603282416938*t;t=e>>>0,e-=t,e*=t,t=e>>>0,e-=t,t+=4294967296*e}return 2.3283064365386963e-10*(t>>>0)}}();this.c=1,this.s0=e(" "),this.s1=e(" "),this.s2=e(" "),this.s0-=e(t),this.s0<0&&(this.s0+=1),this.s1-=e(t),this.s1<0&&(this.s1+=1),this.s2-=e(t),this.s2<0&&(this.s2+=1)}next(){const t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.s0=this.s1,this.s1=this.s2,this.s2=t-(this.c=Math.trunc(t))}}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){const r=new n(t),i=r.next.bind(r);return e&&s(e,r),i.state=()=>s(r,{}),i}class o{constructor(t){this.state=t||{seed:"0"},this.used=!1}static seed(){return Date.now().toString(36).slice(-10)}isUsed(){return this.used}getState(){return this.state}_random(){this.used=!0;const t=this.state,e=i(t.prngstate?"":t.seed,t.prngstate),r=e();return this.state={...t,prngstate:e.state()},r}api(){const t=this._random.bind(this),e={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},r={};for(const n in e){const s=e[n];r[n]=e=>void 0===e?Math.floor(t()*s)+1:Array.from({length:e}).map((()=>Math.floor(t()*s)+1))}return{...r,Die:function(e=6,r){return void 0===r?Math.floor(t()*e)+1:Array.from({length:r}).map((()=>Math.floor(t()*e)+1))},Number:()=>t(),Shuffle:e=>{const r=[...e];let n=e.length,s=0;const i=Array.from({length:n});for(;n;){const e=Math.trunc(n*t());i[s++]=r[e],r[e]=r[--n]}return i},_private:this}}}const a={name:"random",noClient:({api:t})=>t._private.isUsed(),flush:({api:t})=>t._private.getState(),api:({data:t})=>new o(t).api(),setup:({game:t})=>{let{seed:e}=t;return void 0===e&&(e=o.seed()),{seed:e}},playerView:()=>{}}},406:function(t,e,r){"use strict";r.d(e,{K:function(){return T}});r(3261),r(3979);let n=(t=21)=>{let e="",r=t;for(;r--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e};var s=r(5240),i=r(6331),o=r(6419),a=r(1003),c=r(4958);class u extends c.T{connect(){}disconnect(){}sendAction(){}sendChatMessage(){}requestSync(){}updateCredentials(){}updateMatchID(){}updatePlayerID(){}}const l=t=>new u(t);const h=new class{constructor(){this.debugPanel=null,this.currentClient=null,this.clients=new Map,this.subscribers=new Map}register(t){this.clients.set(t,t),this.mountDebug(t),this.notifySubscribers()}unregister(t){if(this.clients.delete(t),this.currentClient===t){this.unmountDebug();for(const[t]of this.clients){if(this.debugPanel)break;this.mountDebug(t)}}this.notifySubscribers()}subscribe(t){const e=Symbol();return this.subscribers.set(e,t),t(this.getState()),()=>{this.subscribers.delete(e)}}switchPlayerID(t){if(this.currentClient.multiplayer)for(const[e]of this.clients)if(e.playerID===t&&!1!==e.debugOpt&&e.multiplayer===this.currentClient.multiplayer)return void this.switchToClient(e);this.currentClient.updatePlayerID(t),this.notifySubscribers()}switchToClient(t){t!==this.currentClient&&(this.unmountDebug(),this.mountDebug(t),this.notifySubscribers())}notifySubscribers(){const t=this.getState();this.subscribers.forEach((e=>{e(t)}))}getState(){return{client:this.currentClient,debuggableClients:this.getDebuggableClients()}}getDebuggableClients(){return[...this.clients.values()].filter((t=>!1!==t.debugOpt))}mountDebug(t){if(!1===t.debugOpt||null!==this.debugPanel||"undefined"===typeof document)return;let e,r=document.body;t.debugOpt&&!0!==t.debugOpt&&(e=t.debugOpt.impl||e,r=t.debugOpt.target||r),e&&(this.currentClient=t,this.debugPanel=new e({target:r,props:{clientManager:this}}))}unmountDebug(){this.debugPanel.$destroy(),this.debugPanel=null,this.currentClient=null}};function p(t,e,r){if(!r&&(null===t||void 0===t)){t=e.getState().ctx.currentPlayer}return t}function f(t,e,r,n,s,o){const a={};for(const c of e)a[c]=(...e)=>{const a=i.A[t](c,e,p(n,r,o),s);r.dispatch(a)};return a}const d=f.bind(null,"makeMove"),y=f.bind(null,"gameEvent"),m=f.bind(null,"plugin");class g{constructor({game:t,debug:e,numPlayers:r,multiplayer:c,matchID:u,playerID:f,credentials:d,enhancer:y}){this.game=(0,o.P)(t),this.playerID=f,this.matchID=u||"default",this.credentials=d,this.multiplayer=c,this.debugOpt=e,this.manager=h,this.gameStateOverride=null,this.subscribers={},this._running=!1,this.reducer=(0,o.C)({game:this.game,isClient:void 0!==c}),this.initialState=null,c||(this.initialState=(0,a.I)({game:this.game,numPlayers:r})),this.reset=()=>{this.store.dispatch((0,i.u)(this.initialState))},this.undo=()=>{const t=(0,i.v)(p(this.playerID,this.store,this.multiplayer),this.credentials);this.store.dispatch(t)},this.redo=()=>{const t=(0,i.w)(p(this.playerID,this.store,this.multiplayer),this.credentials);this.store.dispatch(t)},this.log=[];const m=(0,s.md)(o.T,(()=>t=>e=>{const r=t(e);return this.notifySubscribers(),r}),(t=>e=>r=>{const n=t.getState(),s=e(r);return"clientOnly"in r||r.type===i.p||this.transport.sendAction(n,r),s}),(t=>e=>r=>{const n=e(r),s=t.getState();switch(r.type){case i.M:case i.o:case i.h:case i.R:{const t=s.deltalog;this.log=[...this.log,...t];break}case i.l:this.log=[];break;case i.P:case i.k:{let t=-1;this.log.length>0&&(t=this.log[this.log.length-1]._stateID);let e=r.deltalog||[];e=e.filter((e=>e._stateID>t)),this.log=[...this.log,...e];break}case i.j:this.initialState=r.initialState,this.log=r.log||[]}return n}));y=void 0!==y?(0,s.qC)(m,y):m,this.store=(0,s.MT)(this.reducer,this.initialState,y),c||(c=l),this.transport=c({transportDataCallback:t=>this.receiveTransportData(t),gameKey:t,game:this.game,matchID:u,playerID:f,credentials:d,gameName:this.game.name,numPlayers:r}),this.createDispatchers(),this.chatMessages=[],this.sendChatMessage=t=>{this.transport.sendChatMessage(this.matchID,{id:n(7),sender:this.playerID,payload:t})}}receiveMatchData(t){this.matchData=t,this.notifySubscribers()}receiveChatMessage(t){this.chatMessages=[...this.chatMessages,t],this.notifySubscribers()}receiveTransportData(t){const[e]=t.args;if(e===this.matchID)switch(t.type){case"sync":{const[,e]=t.args,r=(0,i.s)(e);this.receiveMatchData(e.filteredMetadata),this.store.dispatch(r);break}case"update":{const[,e,r]=t.args,n=this.store.getState();if(e._stateID>=n._stateID){const t=(0,i.z)(e,r);this.store.dispatch(t)}break}case"patch":{const[,e,r,n,s]=t.args,o=this.store.getState()._stateID;if(e!==o)break;const a=(0,i.y)(e,r,n,s);this.store.dispatch(a),this.store.getState()._stateID===o&&this.transport.requestSync();break}case"matchData":{const[,e]=t.args;this.receiveMatchData(e);break}case"chat":{const[,e]=t.args;this.receiveChatMessage(e);break}}}notifySubscribers(){Object.values(this.subscribers).forEach((t=>t(this.getState())))}overrideGameState(t){this.gameStateOverride=t,this.notifySubscribers()}start(){this.transport.connect(),this._running=!0,this.manager.register(this)}stop(){this.transport.disconnect(),this._running=!1,this.manager.unregister(this)}subscribe(t){const e=Object.keys(this.subscribers).length;return this.subscribers[e]=t,this.transport.subscribeToConnectionStatus((()=>this.notifySubscribers())),!this._running&&this.multiplayer||t(this.getState()),()=>{delete this.subscribers[e]}}getInitialState(){return this.initialState}getState(){let t=this.store.getState();if(null!==this.gameStateOverride&&(t=this.gameStateOverride),null===t)return t;let e=!0;const r=this.game.flow.isPlayerActive(t.G,t.ctx,this.playerID);return this.multiplayer&&!r&&(e=!1),this.multiplayer||null===this.playerID||void 0===this.playerID||r||(e=!1),void 0!==t.ctx.gameover&&(e=!1),this.multiplayer||(t={...t,G:this.game.playerView(t.G,t.ctx,this.playerID),plugins:(0,i.x)(t,this)}),{...t,log:this.log,isActive:e,isConnected:this.transport.isConnected}}createDispatchers(){this.moves=d(this.game.moveNames,this.store,this.playerID,this.credentials,this.multiplayer),this.events=y(this.game.flow.enabledEventNames,this.store,this.playerID,this.credentials,this.multiplayer),this.plugins=m(this.game.pluginNames,this.store,this.playerID,this.credentials,this.multiplayer)}updatePlayerID(t){this.playerID=t,this.createDispatchers(),this.transport.updatePlayerID(t),this.notifySubscribers()}updateMatchID(t){this.matchID=t,this.createDispatchers(),this.transport.updateMatchID(t),this.notifySubscribers()}updateCredentials(t){this.credentials=t,this.createDispatchers(),this.transport.updateCredentials(t),this.notifySubscribers()}}const{parse:v,stringify:b}=JSON,{keys:w}=Object;r(9382);var E=r(8355);const P=(t,e)=>{if(!t||"string"!==typeof t)throw new Error(`Expected ${e} string, got "${t}".`)},I=t=>P(t,"game name"),_=t=>P(t,"match ID"),O=(t,e)=>{if(!t)throw new Error(`Expected body, got \u201c${t}\u201d.`);for(const r in e){const n=e[r],s=Array.isArray(n)?n:[n],i=t[r];if(!s.includes(typeof i)){const t=s.join("|");throw new TypeError(`Expected body.${r} to be of type ${t}, got \u201c${i}\u201d.`)}}};class S extends Error{constructor(t,e){super(t),this.details=e}}class x{constructor({server:t=""}={}){this.server=t.replace(/\/$/,"")}async request(t,e){const r=await fetch(this.server+t,e);if(!r.ok){let t;try{t=await r.clone().json()}catch{try{t=await r.text()}catch(n){t=n.message}}throw new S(`HTTP status ${r.status}`,t)}return r.json()}async post(t,e){let r={method:"post",body:JSON.stringify(e.body),headers:{"Content-Type":"application/json"}};return e.init&&(r={...r,...e.init,headers:{...r.headers,...e.init.headers}}),this.request(t,r)}async listGames(t){return this.request("/games",t)}async listMatches(t,e,r){I(t);let n="";if(e){const t=[],{isGameover:r,updatedBefore:s,updatedAfter:i}=e;void 0!==r&&t.push(`isGameover=${r}`),s&&t.push(`updatedBefore=${s}`),i&&t.push(`updatedAfter=${i}`),t.length>0&&(n="?"+t.join("&"))}return this.request(`/games/${t}${n}`,r)}async getMatch(t,e,r){return I(t),_(e),this.request(`/games/${t}/${e}`,r)}async createMatch(t,e,r){return I(t),O(e,{numPlayers:"number"}),this.post(`/games/${t}/create`,{body:e,init:r})}async joinMatch(t,e,r,n){return I(t),_(e),O(r,{playerID:["string","undefined"],playerName:"string"}),this.post(`/games/${t}/${e}/join`,{body:r,init:n})}async leaveMatch(t,e,r,n){I(t),_(e),O(r,{playerID:"string",credentials:"string"}),await this.post(`/games/${t}/${e}/leave`,{body:r,init:n})}async updatePlayer(t,e,r,n){I(t),_(e),O(r,{playerID:"string",credentials:"string"}),await this.post(`/games/${t}/${e}/update`,{body:r,init:n})}async playAgain(t,e,r,n){return I(t),_(e),O(r,{playerID:"string",credentials:"string"}),this.post(`/games/${t}/${e}/playAgain`,{body:r,init:n})}}var A,k=r(7378),D=r(3615),M=r.n(D),N=r(1877),C=r(7657);r(9650);function T(t){var e;const{game:r,numPlayers:n,board:s,multiplayer:i,enhancer:o}=t;let{loading:a,debug:c}=t;if(void 0===a){a=()=>k.createElement("div",{className:"bgio-loading"},"connecting...")}return e=class extends k.Component{constructor(t){super(t),void 0===c&&(c=t.debug),this.client=function(t){return new g(t)}({game:r,debug:c,numPlayers:n,multiplayer:i,matchID:t.matchID,playerID:t.playerID,credentials:t.credentials,enhancer:o})}componentDidMount(){this.unsubscribe=this.client.subscribe((()=>this.forceUpdate())),this.client.start()}componentWillUnmount(){this.client.stop(),this.unsubscribe()}componentDidUpdate(t){this.props.matchID!=t.matchID&&this.client.updateMatchID(this.props.matchID),this.props.playerID!=t.playerID&&this.client.updatePlayerID(this.props.playerID),this.props.credentials!=t.credentials&&this.client.updateCredentials(this.props.credentials)}render(){const t=this.client.getState();if(null===t)return k.createElement(a);let e=null;return s&&(e=k.createElement(s,{...t,...this.props,isMultiplayer:!!i,moves:this.client.moves,events:this.client.events,matchID:this.client.matchID,playerID:this.client.playerID,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo,log:this.client.log,matchData:this.client.matchData,sendChatMessage:this.client.sendChatMessage,chatMessages:this.client.chatMessages})),k.createElement("div",{className:"bgio-client"},e)}},e.propTypes={matchID:M().string,playerID:M().string,credentials:M().string,debug:M().any},e.defaultProps={matchID:"default",playerID:null,credentials:null,debug:!0},e}class j{constructor({server:t,gameComponents:e,playerName:r,playerCredentials:n}){this.client=new x({server:t}),this.gameComponents=e,this.playerName=r||"Visitor",this.playerCredentials=n,this.matches=[]}async refresh(){try{this.matches=[];const t=await this.client.listGames();for(const e of t){if(!this._getGameComponents(e))continue;const{matches:t}=await this.client.listMatches(e);this.matches.push(...t)}}catch(t){throw new Error("failed to retrieve list of matches ("+t+")")}}_getMatchInstance(t){for(const e of this.matches)if(e.matchID===t)return e}_getGameComponents(t){for(const e of this.gameComponents)if(e.game.name===t)return e}_findPlayer(t){for(const e of this.matches)if(e.players.some((e=>e.name===t)))return e}async join(t,e,r){try{let n=this._findPlayer(this.playerName);if(n)throw new Error("player has already joined "+n.matchID);if(n=this._getMatchInstance(e),!n)throw new Error("game instance "+e+" not found");const s=await this.client.joinMatch(t,e,{playerID:r,playerName:this.playerName});n.players[Number.parseInt(r)].name=this.playerName,this.playerCredentials=s.playerCredentials}catch(n){throw new Error("failed to join match "+e+" ("+n+")")}}async leave(t,e){try{const r=this._getMatchInstance(e);if(!r)throw new Error("match instance not found");for(const n of r.players)if(n.name===this.playerName)return await this.client.leaveMatch(t,e,{playerID:n.id.toString(),credentials:this.playerCredentials}),delete n.name,void delete this.playerCredentials;throw new Error("player not found in match")}catch(r){throw new Error("failed to leave match "+e+" ("+r+")")}}async disconnect(){const t=this._findPlayer(this.playerName);t&&await this.leave(t.gameName,t.matchID),this.matches=[],this.playerName="Visitor"}async create(t,e){try{const r=this._getGameComponents(t);if(!r)throw new Error("game not found");if(e<r.game.minPlayers||e>r.game.maxPlayers)throw new Error("invalid number of players "+e);await this.client.createMatch(t,{numPlayers:e})}catch(r){throw new Error("failed to create match for "+t+" ("+r+")")}}}class R extends k.Component{constructor(){super(...arguments),this.state={playerName:this.props.playerName,nameErrorMsg:""},this.onClickEnter=()=>{""!==this.state.playerName&&this.props.onEnter(this.state.playerName)},this.onKeyPress=t=>{"Enter"===t.key&&this.onClickEnter()},this.onChangePlayerName=t=>{const e=t.target.value.trim();this.setState({playerName:e,nameErrorMsg:e.length>0?"":"empty player name"})}}render(){return k.createElement("div",null,k.createElement("p",{className:"phase-title"},"Choose a player name:"),k.createElement("input",{type:"text",value:this.state.playerName,onChange:this.onChangePlayerName,onKeyPress:this.onKeyPress}),k.createElement("span",{className:"buttons"},k.createElement("button",{className:"buttons",onClick:this.onClickEnter},"Enter")),k.createElement("br",null),k.createElement("span",{className:"error-msg"},this.state.nameErrorMsg,k.createElement("br",null)))}}R.defaultProps={playerName:""};class B extends k.Component{constructor(){super(...arguments),this._createSeat=t=>t.name||"[free]",this._createButtonJoin=(t,e)=>k.createElement("button",{key:"button-join-"+t.matchID,onClick:()=>this.props.onClickJoin(t.gameName,t.matchID,""+e)},"Join"),this._createButtonLeave=t=>k.createElement("button",{key:"button-leave-"+t.matchID,onClick:()=>this.props.onClickLeave(t.gameName,t.matchID)},"Leave"),this._createButtonPlay=(t,e)=>k.createElement("button",{key:"button-play-"+t.matchID,onClick:()=>this.props.onClickPlay(t.gameName,{matchID:t.matchID,playerID:""+e,numPlayers:t.players.length})},"Play"),this._createButtonSpectate=t=>k.createElement("button",{key:"button-spectate-"+t.matchID,onClick:()=>this.props.onClickPlay(t.gameName,{matchID:t.matchID,numPlayers:t.players.length})},"Spectate"),this._createInstanceButtons=t=>{const e=t.players.find((t=>t.name===this.props.playerName)),r=t.players.find((t=>!t.name));return e&&r?this._createButtonLeave(t):r?this._createButtonJoin(t,r.id):e?k.createElement("div",null,[this._createButtonPlay(t,e.id),this._createButtonLeave(t)]):this._createButtonSpectate(t)}}render(){const t=this.props.match;let e="OPEN";return t.players.some((t=>!t.name))||(e="RUNNING"),k.createElement("tr",{key:"line-"+t.matchID},k.createElement("td",{key:"cell-name-"+t.matchID},t.gameName),k.createElement("td",{key:"cell-status-"+t.matchID},e),k.createElement("td",{key:"cell-seats-"+t.matchID},t.players.map((t=>this._createSeat(t))).join(", ")),k.createElement("td",{key:"cell-buttons-"+t.matchID},this._createInstanceButtons(t)))}}class L extends k.Component{constructor(t){super(t),this.state={selectedGame:0,numPlayers:2},this._createGameNameOption=(t,e)=>k.createElement("option",{key:"name-option-"+e,value:e},t.game.name),this._createNumPlayersOption=t=>k.createElement("option",{key:"num-option-"+t,value:t},t),this._createNumPlayersRange=t=>Array.from({length:t.maxPlayers+1}).map(((t,e)=>e)).slice(t.minPlayers),this.onChangeNumPlayers=t=>{this.setState({numPlayers:Number.parseInt(t.target.value)})},this.onChangeSelectedGame=t=>{const e=Number.parseInt(t.target.value);this.setState({selectedGame:e,numPlayers:this.props.games[e].game.minPlayers})},this.onClickCreate=()=>{this.props.createMatch(this.props.games[this.state.selectedGame].game.name,this.state.numPlayers)};for(const e of t.games){const t=e.game;t.minPlayers||(t.minPlayers=1),t.maxPlayers||(t.maxPlayers=4),console.assert(t.maxPlayers>=t.minPlayers)}this.state={selectedGame:0,numPlayers:t.games[0].game.minPlayers}}render(){return k.createElement("div",null,k.createElement("select",{value:this.state.selectedGame,onChange:t=>this.onChangeSelectedGame(t)},this.props.games.map(((t,e)=>this._createGameNameOption(t,e)))),k.createElement("span",null,"Players:"),k.createElement("select",{value:this.state.numPlayers,onChange:this.onChangeNumPlayers},this._createNumPlayersRange(this.props.games[this.state.selectedGame].game).map((t=>this._createNumPlayersOption(t)))),k.createElement("span",{className:"buttons"},k.createElement("button",{onClick:this.onClickCreate},"Create")))}}!function(t){t.ENTER="enter",t.PLAY="play",t.LIST="list"}(A||(A={}));class U extends k.Component{constructor(t){super(t),this.state={phase:A.ENTER,playerName:"Visitor",runningMatch:null,errorMsg:"",credentialStore:{}},this._createConnection=t=>{const e=this.state.playerName;var r;this.connection=(r={server:t.lobbyServer,gameComponents:t.gameComponents,playerName:e,playerCredentials:this.state.credentialStore[e]},new j(r))},this._updateCredentials=(t,e)=>{this.setState((r=>{const n=Object.assign({},r.credentialStore);return n[t]=e,{credentialStore:n}}))},this._updateConnection=async()=>{await this.connection.refresh(),this.forceUpdate()},this._enterLobby=t=>{this._startRefreshInterval(),this.setState({playerName:t,phase:A.LIST})},this._exitLobby=async()=>{this._clearRefreshInterval(),await this.connection.disconnect(),this.setState({phase:A.ENTER,errorMsg:""})},this._createMatch=async(t,e)=>{try{await this.connection.create(t,e),await this.connection.refresh(),this.setState({})}catch(r){this.setState({errorMsg:r.message})}},this._joinMatch=async(t,e,r)=>{try{await this.connection.join(t,e,r),await this.connection.refresh(),this._updateCredentials(this.connection.playerName,this.connection.playerCredentials)}catch(n){this.setState({errorMsg:n.message})}},this._leaveMatch=async(t,e)=>{try{await this.connection.leave(t,e),await this.connection.refresh(),this._updateCredentials(this.connection.playerName,this.connection.playerCredentials)}catch(r){this.setState({errorMsg:r.message})}},this._startMatch=(t,e)=>{const r=this.connection._getGameComponents(t);if(!r)return void this.setState({errorMsg:"game "+t+" not supported"});let n;if(e.numPlayers>1&&(n=this.props.gameServer?(0,C.S)({server:this.props.gameServer}):(0,C.S)()),1==e.numPlayers){const t=r.game.maxPlayers,e={};for(let r=1;r<t;r++)e[r+""]=E.M;n=(0,C.L)({bots:e})}const s={app:this.props.clientFactory({game:r.game,board:r.board,debug:this.props.debug,multiplayer:n}),matchID:e.matchID,playerID:e.numPlayers>1?e.playerID:"0",credentials:this.connection.playerCredentials};this._clearRefreshInterval(),this.setState({phase:A.PLAY,runningMatch:s})},this._exitMatch=()=>{this._startRefreshInterval(),this.setState({phase:A.LIST,runningMatch:null})},this._getPhaseVisibility=t=>this.state.phase!==t?"hidden":"phase",this.renderMatches=(t,e)=>t.map((t=>{const{matchID:r,gameName:n,players:s}=t;return k.createElement(B,{key:"instance-"+r,match:{matchID:r,gameName:n,players:Object.values(s)},playerName:e,onClickJoin:this._joinMatch,onClickLeave:this._leaveMatch,onClickPlay:this._startMatch})})),this._createConnection(this.props)}componentDidMount(){const t=N.ZP.load("lobbyState")||{};t.phase&&t.phase===A.PLAY&&(t.phase=A.LIST),t.phase&&t.phase!==A.ENTER&&this._startRefreshInterval(),this.setState({phase:t.phase||A.ENTER,playerName:t.playerName||"Visitor",credentialStore:t.credentialStore||{}})}componentDidUpdate(t,e){const r=this.state.playerName,n=this.state.credentialStore[r];if(e.phase!==this.state.phase||e.credentialStore[r]!==n||e.playerName!==r){this._createConnection(this.props),this._updateConnection();const t={phase:this.state.phase,playerName:r,credentialStore:this.state.credentialStore};N.ZP.save("lobbyState",t,{path:"/"})}t.refreshInterval!==this.props.refreshInterval&&this._startRefreshInterval()}componentWillUnmount(){this._clearRefreshInterval()}_startRefreshInterval(){this._clearRefreshInterval(),this._currentInterval=setInterval(this._updateConnection,this.props.refreshInterval)}_clearRefreshInterval(){clearInterval(this._currentInterval)}render(){const{gameComponents:t,renderer:e}=this.props,{errorMsg:r,playerName:n,phase:s,runningMatch:i}=this.state;return e?e({errorMsg:r,gameComponents:t,matches:this.connection.matches,phase:s,playerName:n,runningMatch:i,handleEnterLobby:this._enterLobby,handleExitLobby:this._exitLobby,handleCreateMatch:this._createMatch,handleJoinMatch:this._joinMatch,handleLeaveMatch:this._leaveMatch,handleExitMatch:this._exitMatch,handleRefreshMatches:this._updateConnection,handleStartMatch:this._startMatch}):k.createElement("div",{id:"lobby-view",style:{padding:50}},k.createElement("div",{className:this._getPhaseVisibility(A.ENTER)},k.createElement(R,{key:n,playerName:n,onEnter:this._enterLobby})),k.createElement("div",{className:this._getPhaseVisibility(A.LIST)},k.createElement("p",null,"Welcome, ",n),k.createElement("div",{className:"phase-title",id:"match-creation"},k.createElement("span",null,"Create a match:"),k.createElement(L,{games:t,createMatch:this._createMatch})),k.createElement("p",{className:"phase-title"},"Join a match:"),k.createElement("div",{id:"instances"},k.createElement("table",null,k.createElement("tbody",null,this.renderMatches(this.connection.matches,n))),k.createElement("span",{className:"error-msg"},r,k.createElement("br",null))),k.createElement("p",{className:"phase-title"},"Matches that become empty are automatically deleted.")),k.createElement("div",{className:this._getPhaseVisibility(A.PLAY)},i&&k.createElement(i.app,{matchID:i.matchID,playerID:i.playerID,credentials:i.credentials}),k.createElement("div",{className:"buttons",id:"match-exit"},k.createElement("button",{onClick:this._exitMatch},"Exit match"))),k.createElement("div",{className:"buttons",id:"lobby-exit"},k.createElement("button",{onClick:this._exitLobby},"Exit lobby")))}}U.propTypes={gameComponents:M().array.isRequired,lobbyServer:M().string,gameServer:M().string,debug:M().bool,clientFactory:M().func,refreshInterval:M().number},U.defaultProps={debug:!1,clientFactory:T,refreshInterval:2e3}},6419:function(t,e,r){"use strict";r.d(e,{C:function(){return m},I:function(){return c},P:function(){return a},T:function(){return y}});var n,s,i=r(6331),o=r(3979);function a(t){if(function(t){return void 0!==t.processMove}(t))return t;if(void 0===t.name&&(t.name="default"),void 0===t.deltaState&&(t.deltaState=!1),void 0===t.disableUndo&&(t.disableUndo=!1),void 0===t.setup&&(t.setup=()=>({})),void 0===t.moves&&(t.moves={}),void 0===t.playerView&&(t.playerView=t=>t),void 0===t.plugins&&(t.plugins=[]),t.plugins.forEach((t=>{if(void 0===t.name)throw new Error("Plugin missing name attribute");if(t.name.includes(" "))throw new Error(t.name+": Plugin name must not include spaces")})),t.name.includes(" "))throw new Error(t.name+": Game name must not include spaces");const e=function({moves:t,phases:e,endIf:r,onEnd:n,turn:s,events:o,plugins:a}){void 0===t&&(t={}),void 0===o&&(o={}),void 0===a&&(a=[]),void 0===e&&(e={}),r||(r=()=>{}),n||(n=t=>t),s||(s={});const c={...e};""in c&&(0,i.e)("cannot specify phase with empty name"),c[""]={};const u={},l=new Set;let h=null;Object.keys(t).forEach((t=>l.add(t)));const p=(t,e)=>{const r=(0,i.F)(t,e,a);return t=>{const e=(0,i.E)(t);return r(t.G,e)}},f=t=>e=>{const r=(0,i.E)(e);return t(e.G,r)},d={onEnd:p(n,i.G.GAME_ON_END),endIf:f(r)};for(const j in c){const t=c[j];if(!0===t.start&&(h=j),void 0!==t.moves)for(const e of Object.keys(t.moves))u[j+"."+e]=t.moves[e],l.add(e);void 0===t.endIf&&(t.endIf=()=>{}),void 0===t.onBegin&&(t.onBegin=t=>t),void 0===t.onEnd&&(t.onEnd=t=>t),void 0===t.turn&&(t.turn=s),void 0===t.turn.order&&(t.turn.order=i.T.DEFAULT),void 0===t.turn.onBegin&&(t.turn.onBegin=t=>t),void 0===t.turn.onEnd&&(t.turn.onEnd=t=>t),void 0===t.turn.endIf&&(t.turn.endIf=()=>!1),void 0===t.turn.onMove&&(t.turn.onMove=t=>t),void 0===t.turn.stages&&(t.turn.stages={}),(0,i.a)(t.turn,!0);for(const e in t.turn.stages){const r=t.turn.stages[e].moves||{};for(const t of Object.keys(r))u[j+"."+e+"."+t]=r[t],l.add(t)}if(t.wrapped={onBegin:p(t.onBegin,i.G.PHASE_ON_BEGIN),onEnd:p(t.onEnd,i.G.PHASE_ON_END),endIf:f(t.endIf)},t.turn.wrapped={onMove:p(t.turn.onMove,i.G.TURN_ON_MOVE),onBegin:p(t.turn.onBegin,i.G.TURN_ON_BEGIN),onEnd:p(t.turn.onEnd,i.G.TURN_ON_END),endIf:f(t.turn.endIf)},"function"!==typeof t.next){const{next:e}=t;t.next=()=>e||null}t.wrapped.next=f(t.next)}function y(t){return t.phase?c[t.phase]:c[""]}function m(t){return t}function g(t,e){const r=new Set,n=new Set;for(let s=0;s<e.length;s++){const{fn:i,arg:o,...a}=e[s];if(i===k){n.clear();const e=t.ctx.phase;if(r.has(e)){const e={...t.ctx,phase:null};return{...t,ctx:e}}r.add(e)}const c=[];if(t=i(t,{...a,arg:o,next:c}),i===A)break;const u=O(t);if(u){e.push({fn:A,arg:u,turn:t.ctx.turn,phase:t.ctx.phase,automatic:!0});continue}const l=S(t);if(l)e.push({fn:k,arg:l,turn:t.ctx.turn,phase:t.ctx.phase,automatic:!0});else{if([m,I,_].includes(i)){const r=x(t);if(r){e.push({fn:D,arg:r,turn:t.ctx.turn,phase:t.ctx.phase,automatic:!0});continue}}e.push(...c)}}return t}function v(t,{next:e}){return e.push({fn:b}),t}function b(t,{next:e}){let{G:r,ctx:n}=t;return r=y(n).wrapped.onBegin(t),e.push({fn:w}),{...t,G:r,ctx:n}}function w(t,{currentPlayer:e}){let{ctx:r}=t;const n=y(r);e?(r={...r,currentPlayer:e},n.turn.activePlayers&&(r=(0,i.b)(r,n.turn.activePlayers))):r=(0,i.I)(t,n.turn);const s=r.turn+1;r={...r,turn:s,numMoves:0,_prevActivePlayers:[]};const o=n.turn.wrapped.onBegin({...t,ctx:r});return{...t,G:o,ctx:r,_undo:[],_redo:[]}}function E(t,{arg:e,next:r,phase:n}){const s=y({phase:n});let{ctx:o}=t;if(e&&e.next){if(!(e.next in c))return(0,i.e)("invalid phase: "+e.next),t;o={...o,phase:e.next}}else o={...o,phase:s.wrapped.next(t)||null};return t={...t,ctx:o},r.push({fn:b}),t}function P(t,{arg:e,currentPlayer:r,next:n}){let{G:s,ctx:o}=t;const a=y(o),{endPhase:c,ctx:u}=(0,i.U)(t,r,a.turn,e);return o=u,t={...t,G:s,ctx:o},c?n.push({fn:k,turn:o.turn,phase:o.phase}):n.push({fn:w,currentPlayer:o.currentPlayer}),t}function I(t,{arg:e,playerID:r}){if("string"!==typeof e&&e!==i.S.NULL||(e={stage:e}),"object"!==typeof e)return t;(0,i.a)(e);let{ctx:n}=t,{activePlayers:s,_activePlayersMinMoves:o,_activePlayersMaxMoves:a,_activePlayersNumMoves:c}=n;return void 0!==e.stage&&(null===s&&(s={}),s[r]=e.stage,c[r]=0,e.minMoves&&(null===o&&(o={}),o[r]=e.minMoves),e.maxMoves&&(null===a&&(a={}),a[r]=e.maxMoves)),n={...n,activePlayers:s,_activePlayersMinMoves:o,_activePlayersMaxMoves:a,_activePlayersNumMoves:c},{...t,ctx:n}}function _(t,{arg:e}){return{...t,ctx:(0,i.b)(t.ctx,e)}}function O(t){return d.endIf(t)}function S(t){return y(t.ctx).wrapped.endIf(t)}function x(t){const e=y(t.ctx),r=t.ctx.numMoves||0;return!!(e.turn.maxMoves&&r>=e.turn.maxMoves)||e.turn.wrapped.endIf(t)}function A(t,{arg:e,phase:r}){t=k(t,{phase:r}),void 0===e&&(e=!0),t={...t,ctx:{...t.ctx,gameover:e}};const n=d.onEnd(t);return{...t,G:n}}function k(t,{arg:e,next:r,turn:n,automatic:s}){t=D(t,{turn:n,force:!0,automatic:!0});const{phase:o,turn:a}=t.ctx;if(r&&r.push({fn:E,arg:e,phase:o}),null===o)return t;const c=y(t.ctx).wrapped.onEnd(t),u={...t.ctx,phase:null},l=(0,i.g)("endPhase",e),{_stateID:h}=t,p={action:l,_stateID:h,turn:a,phase:o};s&&(p.automatic=!0);const f=[...t.deltalog||[],p];return{...t,G:c,ctx:u,deltalog:f}}function D(t,{arg:e,next:r,turn:n,force:s,automatic:o,playerID:a}){if(n!==t.ctx.turn)return t;const{currentPlayer:c,numMoves:u,phase:l,turn:h}=t.ctx,p=y(t.ctx),f=u||0;if(!s&&p.turn.minMoves&&f<p.turn.minMoves)return(0,i.i)(`cannot end turn before making ${p.turn.minMoves} moves`),t;const d=p.turn.wrapped.onEnd(t);r&&r.push({fn:P,arg:e,currentPlayer:c});let m={...t.ctx,activePlayers:null};if(e&&e.remove){a=a||c;const e=m.playOrder.filter((t=>t!=a)),n=m.playOrderPos>e.length-1?0:m.playOrderPos;if(m={...m,playOrder:e,playOrderPos:n},0===e.length)return r.push({fn:k,turn:h,phase:l}),t}const g=(0,i.g)("endTurn",e),{_stateID:v}=t,b={action:g,_stateID:v,turn:h,phase:l};o&&(b.automatic=!0);const w=[...t.deltalog||[],b];return{...t,G:d,ctx:m,deltalog:w,_undo:[],_redo:[]}}function M(t,{arg:e,next:r,automatic:n,playerID:s}){s=s||t.ctx.currentPlayer;let{ctx:o,_stateID:a}=t,{activePlayers:c,_activePlayersNumMoves:u,_activePlayersMinMoves:l,_activePlayersMaxMoves:h,phase:p,turn:f}=o;const d=null!==c&&s in c,m=y(o);if(!e&&d){const t=m.turn.stages[c[s]];t&&t.next&&(e=t.next)}if(r&&r.push({fn:I,arg:e,playerID:s}),!d)return t;const g=u[s]||0;if(l&&l[s]&&g<l[s])return(0,i.i)(`cannot end stage before making ${l[s]} moves`),t;c={...c},delete c[s],l&&(l={...l},delete l[s]),h&&(h={...h},delete h[s]),o=(0,i.c)({...o,activePlayers:c,_activePlayersMinMoves:l,_activePlayersMaxMoves:h});const v={action:(0,i.g)("endStage",e),_stateID:a,turn:f,phase:p};n&&(v.automatic=!0);const b=[...t.deltalog||[],v];return{...t,ctx:o,deltalog:b}}function N(e,r,n){const s=y(e),o=s.turn.stages,{activePlayers:a}=e;if(a&&void 0!==a[n]&&a[n]!==i.S.NULL&&void 0!==o[a[n]]&&void 0!==o[a[n]].moves){const t=o[a[n]].moves;if(r in t)return t[r]}else if(s.moves){if(r in s.moves)return s.moves[r]}else if(r in t)return t[r];return null}const C={endStage:function(t,e){return g(t,[{fn:M,playerID:e}])},setStage:function(t,e,r){return g(t,[{fn:M,arg:r,playerID:e}])},endTurn:function(t,e,r){return g(t,[{fn:D,turn:t.ctx.turn,phase:t.ctx.phase,arg:r}])},pass:function(t,e,r){return g(t,[{fn:D,turn:t.ctx.turn,phase:t.ctx.phase,force:!0,arg:r}])},endPhase:function(t){return g(t,[{fn:k,phase:t.ctx.phase,turn:t.ctx.turn}])},setPhase:function(t,e,r){return g(t,[{fn:k,phase:t.ctx.phase,turn:t.ctx.turn,arg:{next:r}}])},endGame:function(t,e,r){return g(t,[{fn:A,turn:t.ctx.turn,phase:t.ctx.phase,arg:r}])},setActivePlayers:function(t,e,r){return g(t,[{fn:_,arg:r}])}},T=[];return!1!==o.endTurn&&T.push("endTurn"),!1!==o.pass&&T.push("pass"),!1!==o.endPhase&&T.push("endPhase"),!1!==o.setPhase&&T.push("setPhase"),!1!==o.endGame&&T.push("endGame"),!1!==o.setActivePlayers&&T.push("setActivePlayers"),!1!==o.endStage&&T.push("endStage"),!1!==o.setStage&&T.push("setStage"),{ctx:t=>({numPlayers:t,turn:0,currentPlayer:"0",playOrder:[...Array.from({length:t})].map(((t,e)=>e+"")),playOrderPos:0,phase:h,activePlayers:null}),init:t=>g(t,[{fn:v}]),isPlayerActive:function(t,e,r){return e.activePlayers?r in e.activePlayers:e.currentPlayer===r},eventHandlers:C,eventNames:Object.keys(C),enabledEventNames:T,moveMap:u,moveNames:[...l.values()],processMove:function(t,e){const{playerID:r,type:n}=e,{currentPlayer:s,activePlayers:i,_activePlayersMaxMoves:o}=t.ctx,a=N(t.ctx,n,r),c=!a||"function"===typeof a||!0!==a.noLimit;let{numMoves:u,_activePlayersNumMoves:l}=t.ctx;c&&(r===s&&u++,i&&l[r]++),t={...t,ctx:{...t.ctx,numMoves:u,_activePlayersNumMoves:l}},o&&l[r]>=o[r]&&(t=M(t,{playerID:r,automatic:!0}));const h=y(t.ctx).turn.wrapped.onMove({...t,ctx:{...t.ctx,playerID:r}});return g(t={...t,G:h},[{fn:m}])},processEvent:function(t,e){const{type:r,playerID:n,args:s}=e.payload;return"function"!==typeof C[r]?t:C[r](t,n,...Array.isArray(s)?s:[s])},getMove:N}}(t);return{...t,flow:e,moveNames:e.moveNames,pluginNames:t.plugins.map((t=>t.name)),processMove:(r,n)=>{let s=e.getMove(r.ctx,n.type,n.playerID);if(c(s)&&(s=s.move),s instanceof Function){const e=(0,i.F)(s,i.G.MOVE,t.plugins),o={...(0,i.E)(r),playerID:n.playerID};let a=[];return void 0!==n.args&&(a=Array.isArray(n.args)?n.args:[n.args]),e(r.G,o,...a)}return(0,i.e)(`invalid move object: ${n.type}`),r.G}}}function c(t){return t instanceof Object&&void 0!==t.move}!function(t){t.UnauthorizedAction="update/unauthorized_action",t.MatchNotFound="update/match_not_found",t.PatchFailed="update/patch_failed"}(n||(n={})),function(t){t.StaleStateId="action/stale_state_id",t.UnavailableMove="action/unavailable_move",t.InvalidMove="action/invalid_move",t.InactivePlayer="action/inactive_player",t.GameOver="action/gameover",t.ActionDisabled="action/action_disabled",t.ActionInvalid="action/action_invalid",t.PluginActionInvalid="action/plugin_invalid"}(s||(s={}));const u=t=>null!==t.payload.playerID&&void 0!==t.payload.playerID;function l(t,e){if(e.game.disableUndo)return t;const r={G:t.G,ctx:t.ctx,plugins:t.plugins,playerID:e.action.payload.playerID||t.ctx.currentPlayer};return"MAKE_MOVE"===e.action.type&&(r.moveType=e.action.payload.type),{...t,_undo:[...t._undo,r],_redo:[]}}function h(t,e,r){const n={action:e,_stateID:t._stateID,turn:t.ctx.turn,phase:t.ctx.phase},s=t.plugins.log.data.metadata;return void 0!==s&&(n.metadata=s),"object"===typeof r&&!0===r.redact&&(n.redact=!0),{...t,deltalog:[n]}}function p(t,e,r){const[n,o]=(0,i.q)(t,r);return o?[n,d(e,s.PluginActionInvalid,o)]:[n]}function f(t){if(!t)return[null,void 0];const{transients:e,...r}=t;return[r,e]}function d(t,e,r){return{...t,transients:{error:{type:e,payload:r}}}}const y=t=>e=>r=>{const n=e(r);if(r.type===i.p)return n;{const[,e]=f(t.getState());return"undefined"!==typeof e?(t.dispatch((0,i.r)()),{...n,transients:e}):n}};function m({game:t,isClient:e}){return t=a(t),(r=null,a)=>{let[c]=f(r);switch(a.type){case i.p:return c;case i.o:{if(c={...c,deltalog:[]},e)return c;if(void 0!==c.ctx.gameover)return(0,i.e)("cannot call event after game end"),d(c,s.GameOver);if(u(a)&&!t.flow.isPlayerActive(c.G,c.ctx,a.payload.playerID))return(0,i.e)(`disallowed event: ${a.payload.type}`),d(c,s.InactivePlayer);c=(0,i.m)(c,{game:t,isClient:!1,playerID:a.payload.playerID});let r,n=t.flow.processEvent(c,a);return[n,r]=p(n,c,{game:t,isClient:!1}),r?r:(n=l(n,{game:t,action:a}),{...n,_stateID:c._stateID+1})}case i.M:{const r=c={...c,deltalog:[]},n=t.flow.getMove(c.ctx,a.payload.type,a.payload.playerID||c.ctx.currentPlayer);if(null===n)return(0,i.e)(`disallowed move: ${a.payload.type}`),d(c,s.UnavailableMove);if(e&&!1===n.client)return c;if(void 0!==c.ctx.gameover)return(0,i.e)("cannot make move after game end"),d(c,s.GameOver);if(u(a)&&!t.flow.isPlayerActive(c.G,c.ctx,a.payload.playerID))return(0,i.e)(`disallowed move: ${a.payload.type}`),d(c,s.InactivePlayer);c=(0,i.m)(c,{game:t,isClient:e,playerID:a.payload.playerID});const o=t.processMove(c,a.payload);if(o===i.n)return(0,i.e)(`invalid move: ${a.payload.type} args: ${a.payload.args}`),d(c,s.InvalidMove);const f={...c,G:o};if(e&&(0,i.N)(f,{game:t}))return c;if(c=f,e){let e;return[c,e]=p(c,r,{game:t,isClient:!0}),e||{...c,_stateID:c._stateID+1}}let y;return c=h(c,a,n),c=t.flow.processMove(c,a.payload),[c,y]=p(c,r,{game:t}),y?y:(c=l(c,{game:t,action:a}),{...c,_stateID:c._stateID+1})}case i.l:case i.k:case i.j:return a.state;case i.h:{if(c={...c,deltalog:[]},t.disableUndo)return(0,i.e)("Undo is not enabled"),d(c,s.ActionDisabled);const{G:e,ctx:r,_undo:n,_redo:o,_stateID:l}=c;if(n.length<2)return(0,i.e)("No moves to undo"),d(c,s.ActionInvalid);const p=n[n.length-1],f=n[n.length-2];if(u(a)&&a.payload.playerID!==p.playerID)return(0,i.e)("Cannot undo other players' moves"),d(c,s.ActionInvalid);if(p.moveType){if(!((t,e,r)=>!function(t){return void 0!==t.undoable}(r)||(r.undoable instanceof Function?r.undoable(t,e):r.undoable))(e,r,t.flow.getMove(f.ctx,p.moveType,p.playerID)))return(0,i.e)("Move cannot be undone"),d(c,s.ActionInvalid)}return c=h(c,a),{...c,G:f.G,ctx:f.ctx,plugins:f.plugins,_stateID:l+1,_undo:n.slice(0,-1),_redo:[p,...o]}}case i.R:{if(c={...c,deltalog:[]},t.disableUndo)return(0,i.e)("Redo is not enabled"),d(c,s.ActionDisabled);const{_undo:e,_redo:r,_stateID:n}=c;if(0===r.length)return(0,i.e)("No moves to redo"),d(c,s.ActionInvalid);const o=r[0];return u(a)&&a.payload.playerID!==o.playerID?((0,i.e)("Cannot redo other players' moves"),d(c,s.ActionInvalid)):(c=h(c,a),{...c,G:o.G,ctx:o.ctx,plugins:o.plugins,_stateID:n+1,_undo:[...e,o],_redo:r.slice(1)})}case i.d:return(0,i.f)(c,a,{game:t});case i.P:{const t=c,e=JSON.parse(JSON.stringify(t)),r=(0,o.af)(e,a.patch);return r.some((t=>null!==t))?((0,i.e)(`Patch ${JSON.stringify(a.patch)} apply failed`),d(t,n.PatchFailed,r)):e}default:return c}}}},7657:function(t,e,r){"use strict";r.d(e,{L:function(){return P},S:function(){return O}});var n,s=r(4958),i=r(1003);function o(t){return t.type()===n.SYNC}!function(t){t[t.SYNC=0]="SYNC",t[t.ASYNC=1]="ASYNC"}(n||(n={}));const a=({game:t,numPlayers:e,setupData:r,unlisted:n})=>{e&&"number"===typeof e||(e=2);const s=t.validateSetupData&&t.validateSetupData(r,e);if(void 0!==s)return{setupDataError:s};const o=(({game:t,unlisted:e,setupData:r,numPlayers:n})=>{const s={gameName:t.name,unlisted:!!e,players:{},createdAt:Date.now(),updatedAt:Date.now()};void 0!==r&&(s.setupData=r);for(let i=0;i<n;i++)s.players[i]={id:i};return s})({game:t,numPlayers:e,setupData:r,unlisted:n});return{metadata:o,initialState:(0,i.I)({game:t,numPlayers:e,setupData:r})}};var c=r(5240),u=r(6331),l=r(6419);const h=t=>Object.values(t.players).map((t=>{const{credentials:e,...r}=t;return r}));var p=r(3979);const f=(t,e,r)=>({...r,G:t.playerView(r.G,r.ctx,e),plugins:(0,u.x)(r,{playerID:e,game:t}),deltalog:void 0,_undo:[],_redo:[]});function d(t,e){return void 0===t?t:t.map((t=>{if(null!==e&&+e===+t.action.payload.playerID)return t;if(!0!==t.redact)return t;const r={...t.action.payload,args:null},n={...t,action:{...t.action,payload:r}},{redact:s,...i}=n;return i}))}var y=r(9650);class m extends class{type(){return n.SYNC}connect(){}createMatch(t,e){if(this.createGame)return console.warn("The database connector does not implement a createMatch method.","\nUsing the deprecated createGame method instead."),this.createGame(t,e);console.error("The database connector does not implement a createMatch method.")}listMatches(t){if(this.listGames)return console.warn("The database connector does not implement a listMatches method.","\nUsing the deprecated listGames method instead."),this.listGames(t);console.error("The database connector does not implement a listMatches method.")}}{constructor(){super(),this.state=new Map,this.initial=new Map,this.metadata=new Map,this.log=new Map}createMatch(t,e){this.initial.set(t,e.initialState),this.setState(t,e.initialState),this.setMetadata(t,e.metadata)}setMetadata(t,e){this.metadata.set(t,e)}setState(t,e,r){if(r&&r.length>0){const e=this.log.get(t)||[];this.log.set(t,[...e,...r])}this.state.set(t,e)}fetch(t,e){const r={};return e.state&&(r.state=this.state.get(t)),e.metadata&&(r.metadata=this.metadata.get(t)),e.log&&(r.log=this.log.get(t)||[]),e.initialState&&(r.initialState=this.initial.get(t)),r}wipe(t){this.state.delete(t),this.metadata.delete(t)}listMatches(t){return[...this.metadata.entries()].filter((([,e])=>{if(!t)return!0;if(void 0!==t.gameName&&e.gameName!==t.gameName)return!1;if(void 0!==t.where){if(void 0!==t.where.isGameover){if(void 0!==e.gameover!==t.where.isGameover)return!1}if(void 0!==t.where.updatedBefore&&e.updatedAt>=t.where.updatedBefore)return!1;if(void 0!==t.where.updatedAfter&&e.updatedAt<=t.where.updatedAfter)return!1}return!0})).map((([t])=>t))}}class g extends Map{constructor(t){super(),this.key=t;(JSON.parse(localStorage.getItem(this.key))||[]).forEach((t=>this.set(...t)))}sync(){const t=[...this.entries()];localStorage.setItem(this.key,JSON.stringify(t))}set(t,e){return super.set(t,e),this.sync(),this}delete(t){const e=super.delete(t);return this.sync(),e}}class v extends m{constructor(t="bgio"){super();const e=e=>new g(`${t}_${e}`);this.state=e("state"),this.initial=e("initial"),this.metadata=e("metadata"),this.log=e("log")}}class b extends class{constructor(t,e,r,n){this.game=(0,l.P)(t),this.storageAPI=e,this.transportAPI=r,this.subscribeCallback=()=>{},this.auth=n}subscribe(t){this.subscribeCallback=t}async onUpdate(t,e,r,n){if(!t||!t.payload)return{error:"missing action or action payload"};let s;if(o(this.storageAPI)?({metadata:s}=this.storageAPI.fetch(r,{metadata:!0})):({metadata:s}=await this.storageAPI.fetch(r,{metadata:!0})),this.auth){if(!(await this.auth.authenticateCredentials({playerID:n,credentials:t.payload.credentials,metadata:s})))return{error:"unauthorized action"}}const i=(t=>{const{credentials:e,...r}=t.payload;return{...t,payload:r}})(t),a=r;let h;if(o(this.storageAPI)?({state:h}=this.storageAPI.fetch(a,{state:!0})):({state:h}=await this.storageAPI.fetch(a,{state:!0})),void 0===h)return(0,u.e)(`game not found, matchID=[${a}]`),{error:"game not found"};if(void 0!==h.ctx.gameover)return void(0,u.e)(`game over - matchID=[${a}] - playerID=[${n}] - action[${i.payload.type}]`);const p=(0,l.C)({game:this.game}),f=(0,c.md)(l.T),d=(0,c.MT)(p,h,f);if(i.type==u.h||i.type==u.R){const t=null!==h.ctx.activePlayers,e=h.ctx.currentPlayer===n;if(!t&&!e||t&&(void 0===h.ctx.activePlayers[n]||Object.keys(h.ctx.activePlayers).length>1))return void(0,u.e)(`playerID=[${n}] cannot undo / redo right now`)}if(!this.game.flow.isPlayerActive(h.G,h.ctx,n))return void(0,u.e)(`player not active - playerID=[${n}] - action[${i.payload.type}]`);const y=i.type==u.M?this.game.flow.getMove(h.ctx,i.payload.type,n):null;if(i.type==u.M&&!y)return void(0,u.e)(`move not processed - canPlayerMakeMove=false - playerID=[${n}] - action[${i.payload.type}]`);if(h._stateID!==e&&!(y&&(0,l.I)(y)&&y.ignoreStaleStateID))return void(0,u.e)(`invalid stateID, was=[${e}], expected=[${h._stateID}] - playerID=[${n}] - action[${i.payload.type}]`);const m=d.getState();d.dispatch(i),h=d.getState(),this.subscribeCallback({state:h,action:i,matchID:r}),this.game.deltaState?this.transportAPI.sendAll({type:"patch",args:[r,e,m,h]}):this.transportAPI.sendAll({type:"update",args:[r,h]});const{deltalog:g,...v}=h;let b;if(!s||void 0!==s.gameover&&null!==s.gameover||(b={...s,updatedAt:Date.now()},void 0!==h.ctx.gameover&&(b.gameover=h.ctx.gameover)),o(this.storageAPI))this.storageAPI.setState(a,v,g),b&&this.storageAPI.setMetadata(a,b);else{const t=[this.storageAPI.setState(a,v,g)];b&&t.push(this.storageAPI.setMetadata(a,b)),await Promise.all(t)}}async onSync(t,e,r,n=2){const s=t,i={state:!0,metadata:!0,log:!0,initialState:!0},c=o(this.storageAPI)?this.storageAPI.fetch(s,i):await this.storageAPI.fetch(s,i);let{state:u,initialState:l,log:p,metadata:f}=c;if(this.auth&&void 0!==e&&null!==e){if(!(await this.auth.authenticateCredentials({playerID:e,credentials:r,metadata:f})))return{error:"unauthorized"}}if(void 0===u){const e=a({game:this.game,unlisted:!0,numPlayers:n,setupData:void 0});if("setupDataError"in e)return{error:"game requires setupData"};l=u=e.initialState,f=e.metadata,this.subscribeCallback({state:u,matchID:t}),o(this.storageAPI)?this.storageAPI.createMatch(s,{initialState:l,metadata:f}):await this.storageAPI.createMatch(s,{initialState:l,metadata:f})}const d={state:u,log:p,filteredMetadata:f?h(f):void 0,initialState:l};this.transportAPI.send({playerID:e,type:"sync",args:[t,d]})}async onConnectionChange(t,e,r,n){const s=t;if(void 0===e||null===e)return;let i;if(o(this.storageAPI)?({metadata:i}=this.storageAPI.fetch(s,{metadata:!0})):({metadata:i}=await this.storageAPI.fetch(s,{metadata:!0})),void 0===i)return(0,u.e)(`metadata not found for matchID=[${s}]`),{error:"metadata not found"};if(void 0===i.players[e])return(0,u.e)(`Player not in the match, matchID=[${s}] playerID=[${e}]`),{error:"player not in the match"};if(this.auth){if(!(await this.auth.authenticateCredentials({playerID:e,credentials:r,metadata:i})))return{error:"unauthorized"}}i.players[e].isConnected=n;const a=h(i);this.transportAPI.sendAll({type:"matchData",args:[t,a]}),o(this.storageAPI)?this.storageAPI.setMetadata(s,i):await this.storageAPI.setMetadata(s,i)}async onChatMessage(t,e,r){const n=t;if(this.auth){const{metadata:t}=await this.storageAPI.fetch(n,{metadata:!0});if(!e||"string"!==typeof e.sender)return{error:"unauthorized"};if(!(await this.auth.authenticateCredentials({playerID:e.sender,credentials:r,metadata:t})))return{error:"unauthorized"}}this.transportAPI.sendAll({type:"chat",args:[t,e]})}}{constructor({game:t,bots:e,storageKey:r,persist:n}){const s={},i={};if(t&&t.ai&&e)for(const u in e){const r=e[u];i[u]=new r({game:t,enumerate:t.ai.enumerate,seed:t.seed})}const o=({playerID:t,...e})=>{const r=s[t];void 0!==r&&r(a(t,e))},a=(t=>(e,r)=>{switch(r.type){case"patch":{const[n,s,i,o]=r.args,a=d(o.deltalog,e),c=f(t,e,o),u=o._stateID,l=f(t,e,i);return{type:"patch",args:[n,s,u,(0,p.rh)(l,c),a]}}case"update":{const[n,s]=r.args,i=d(s.deltalog,e);return{type:"update",args:[n,f(t,e,s),i]}}case"sync":{const[n,s]=r.args,i=f(t,e,s.state),o=d(s.log,e);return{type:"sync",args:[n,{...s,state:i,log:o}]}}default:return r}})(t),c={send:o,sendAll:t=>{for(const e in s)o({playerID:e,...t})}};super(t,n?new v(r):new m,c),this.connect=(t,e)=>{s[t]=e},this.subscribe((({state:t,matchID:r})=>{if(!e)return;const n=function(t,e){if(void 0!==t.ctx.gameover)return null;if(t.ctx.activePlayers){for(const r of Object.keys(e))if(r in t.ctx.activePlayers)return r}else if(t.ctx.currentPlayer in e)return t.ctx.currentPlayer;return null}(t,i);null!==n&&setTimeout((async()=>{const e=await i[n].play(t,n);await this.onUpdate(e.action,t._stateID,r,e.action.payload.playerID)}),100)}))}}class w extends s.T{constructor({master:t,...e}){super(e),this.master=t}sendChatMessage(t,e){const r=[t,e,this.credentials];this.master.onChatMessage(...r)}sendAction(t,e){this.master.onUpdate(e,t._stateID,this.matchID,this.playerID)}requestSync(){this.master.onSync(this.matchID,this.playerID,this.credentials,this.numPlayers)}connect(){this.setConnectionStatus(!0),this.master.connect(this.playerID,(t=>this.notifyClient(t))),this.requestSync()}disconnect(){this.setConnectionStatus(!1)}updateMatchID(t){this.matchID=t,this.connect()}updatePlayerID(t){this.playerID=t,this.connect()}updateCredentials(t){this.credentials=t,this.connect()}}const E=new Map;function P({bots:t,persist:e,storageKey:r}={}){return n=>{const{gameKey:s,game:i}=n;let o;const a=E.get(s);return a&&a.bots===t&&a.storageKey===r&&a.persist===e&&(o=a.master),o||(o=new b({game:i,bots:t,persist:e,storageKey:r}),E.set(s,{master:o,bots:t,persist:e,storageKey:r})),new w({master:o,...n})}}const I=y.ZP;class _ extends s.T{constructor({socket:t,socketOpts:e,server:r,...n}){super(n),this.server=r,this.socket=t,this.socketOpts=e}sendAction(t,e){const r=[e,t._stateID,this.matchID,this.playerID];this.socket.emit("update",...r)}sendChatMessage(t,e){const r=[t,e,this.credentials];this.socket.emit("chat",...r)}connect(){if(!this.socket)if(this.server){let t=this.server;-1==t.search(/^https?:\/\//)&&(t="http://"+this.server),"/"!=t.slice(-1)&&(t+="/"),this.socket=I(t+this.gameName,this.socketOpts)}else this.socket=I("/"+this.gameName,this.socketOpts);this.socket.on("patch",((t,e,r,n,s)=>{this.notifyClient({type:"patch",args:[t,e,r,n,s]})})),this.socket.on("update",((t,e,r)=>{this.notifyClient({type:"update",args:[t,e,r]})})),this.socket.on("sync",((t,e)=>{this.notifyClient({type:"sync",args:[t,e]})})),this.socket.on("matchData",((t,e)=>{this.notifyClient({type:"matchData",args:[t,e]})})),this.socket.on("chat",((t,e)=>{this.notifyClient({type:"chat",args:[t,e]})})),this.socket.on("connect",(()=>{this.requestSync(),this.setConnectionStatus(!0)})),this.socket.on("disconnect",(()=>{this.setConnectionStatus(!1)}))}disconnect(){this.socket.close(),this.socket=null,this.setConnectionStatus(!1)}requestSync(){if(this.socket){const t=[this.matchID,this.playerID,this.credentials,this.numPlayers];this.socket.emit("sync",...t)}}updateMatchID(t){this.matchID=t,this.requestSync()}updatePlayerID(t){this.playerID=t,this.requestSync()}updateCredentials(t){this.credentials=t,this.requestSync()}}function O({server:t,socketOpts:e}={}){return r=>new _({server:t,socketOpts:e,...r})}},4958:function(t,e,r){"use strict";r.d(e,{T:function(){return n}});class n{constructor({transportDataCallback:t,gameName:e,playerID:r,matchID:n,credentials:s,numPlayers:i}){this.connectionStatusCallback=()=>{},this.isConnected=!1,this.transportDataCallback=t,this.gameName=e||"default",this.playerID=r||null,this.matchID=n||"default",this.credentials=s,this.numPlayers=i||2}subscribeToConnectionStatus(t){this.connectionStatusCallback=t}setConnectionStatus(t){this.isConnected=t,this.connectionStatusCallback()}notifyClient(t){this.transportDataCallback(t)}}},6331:function(t,e,r){"use strict";function n(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map((function(t){return"'"+t+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function s(t){return!!t&&!!t[z]}function i(t){return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===J}(t)||Array.isArray(t)||!!t[V]||!!t.constructor[V]||p(t)||f(t))}function o(t,e,r){void 0===r&&(r=!1),0===a(t)?(r?Object.keys:K)(t).forEach((function(n){r&&"symbol"==typeof n||e(n,t[n],t)})):t.forEach((function(r,n){return e(n,r,t)}))}function a(t){var e=t[z];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:p(t)?2:f(t)?3:0}function c(t,e){return 2===a(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function u(t,e){return 2===a(t)?t.get(e):t[e]}function l(t,e,r){var n=a(t);2===n?t.set(e,r):3===n?(t.delete(e),t.add(r)):t[e]=r}function h(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function p(t){return G&&t instanceof Map}function f(t){return F&&t instanceof Set}function d(t){return t.o||t.t}function y(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=H(t);delete e[z];for(var r=K(e),n=0;n<r.length;n++){var s=r[n],i=e[s];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(e[s]={configurable:!0,writable:!0,enumerable:i.enumerable,value:t[s]})}return Object.create(Object.getPrototypeOf(t),e)}function m(t,e){return void 0===e&&(e=!1),v(t)||s(t)||!i(t)||(a(t)>1&&(t.set=t.add=t.clear=t.delete=g),Object.freeze(t),e&&o(t,(function(t,e){return m(e,!0)}),!0)),t}function g(){n(2)}function v(t){return null==t||"object"!=typeof t||Object.isFrozen(t)}function b(t){var e=Y[t];return e||n(18,t),e}function w(){return L}function E(t,e){e&&(b("Patches"),t.u=[],t.s=[],t.v=e)}function P(t){I(t),t.p.forEach(O),t.p=null}function I(t){t===L&&(L=t.l)}function _(t){return L={p:[],l:L,h:t,m:!0,_:0}}function O(t){var e=t[z];0===e.i||1===e.i?e.j():e.O=!0}function S(t,e){e._=e.p.length;var r=e.p[0],s=void 0!==t&&t!==r;return e.h.g||b("ES5").S(e,t,s),s?(r[z].P&&(P(e),n(4)),i(t)&&(t=x(e,t),e.l||k(e,t)),e.u&&b("Patches").M(r[z].t,t,e.u,e.s)):t=x(e,r,[]),P(e),e.u&&e.v(e.u,e.s),t!==q?t:void 0}function x(t,e,r){if(v(e))return e;var n=e[z];if(!n)return o(e,(function(s,i){return A(t,n,e,s,i,r)}),!0),e;if(n.A!==t)return e;if(!n.P)return k(t,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var s=4===n.i||5===n.i?n.o=y(n.k):n.o;o(3===n.i?new Set(s):s,(function(e,i){return A(t,n,s,e,i,r)})),k(t,s,!1),r&&t.u&&b("Patches").R(n,r,t.u,t.s)}return n.o}function A(t,e,r,n,o,a){if(s(o)){var u=x(t,o,a&&e&&3!==e.i&&!c(e.D,n)?a.concat(n):void 0);if(l(r,n,u),!s(u))return;t.m=!1}if(i(o)&&!v(o)){if(!t.h.F&&t._<1)return;x(t,o),e&&e.A.l||k(t,o)}}function k(t,e,r){void 0===r&&(r=!1),t.h.F&&t.m&&m(e,r)}function D(t,e){var r=t[z];return(r?d(r):t)[e]}function M(t,e){if(e in t)for(var r=Object.getPrototypeOf(t);r;){var n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Object.getPrototypeOf(r)}}function N(t){t.P||(t.P=!0,t.l&&N(t.l))}function C(t){t.o||(t.o=y(t.t))}function T(t,e,r){var n=p(e)?b("MapSet").N(e,r):f(e)?b("MapSet").T(e,r):t.g?function(t,e){var r=Array.isArray(t),n={i:r?1:0,A:e?e.A:w(),P:!1,I:!1,D:{},l:e,t:t,k:null,o:null,j:null,C:!1},s=n,i=W;r&&(s=[n],i=Z);var o=Proxy.revocable(s,i),a=o.revoke,c=o.proxy;return n.k=c,n.j=a,c}(e,r):b("ES5").J(e,r);return(r?r.A:w()).p.push(n),n}function j(t){return s(t)||n(22,t),function t(e){if(!i(e))return e;var r,n=e[z],s=a(e);if(n){if(!n.P&&(n.i<4||!b("ES5").K(n)))return n.t;n.I=!0,r=R(e,s),n.I=!1}else r=R(e,s);return o(r,(function(e,s){n&&u(n.t,e)===s||l(r,e,t(s))})),3===s?new Set(r):r}(t)}function R(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return y(t)}r.d(e,{A:function(){return It},B:function(){return ft},E:function(){return Rt},F:function(){return Bt},G:function(){return St},I:function(){return Ht},M:function(){return nt},N:function(){return Gt},P:function(){return lt},R:function(){return it},S:function(){return Zt},T:function(){return Wt},U:function(){return Yt},a:function(){return qt},b:function(){return Vt},c:function(){return zt},d:function(){return ht},e:function(){return Nt},f:function(){return jt},g:function(){return dt},h:function(){return ct},i:function(){return Mt},j:function(){return at},k:function(){return ut},l:function(){return ot},m:function(){return Ut},n:function(){return _t},o:function(){return st},p:function(){return pt},q:function(){return Ft},r:function(){return Pt},s:function(){return mt},t:function(){return Lt},u:function(){return bt},v:function(){return wt},w:function(){return Et},x:function(){return $t},y:function(){return gt},z:function(){return vt}});var B,L,U="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),G="undefined"!=typeof Map,F="undefined"!=typeof Set,$="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,q=U?Symbol.for("immer-nothing"):((B={})["immer-nothing"]=!0,B),V=U?Symbol.for("immer-draftable"):"__$immer_draftable",z=U?Symbol.for("immer-state"):"__$immer_state",J=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),K="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,H=Object.getOwnPropertyDescriptors||function(t){var e={};return K(t).forEach((function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)})),e},Y={},W={get:function(t,e){if(e===z)return t;var r=d(t);if(!c(r,e))return function(t,e,r){var n,s=M(e,r);return s?"value"in s?s.value:null===(n=s.get)||void 0===n?void 0:n.call(t.k):void 0}(t,r,e);var n=r[e];return t.I||!i(n)?n:n===D(t.t,e)?(C(t),t.o[e]=T(t.A.h,n,t)):n},has:function(t,e){return e in d(t)},ownKeys:function(t){return Reflect.ownKeys(d(t))},set:function(t,e,r){var n=M(d(t),e);if(null==n?void 0:n.set)return n.set.call(t.k,r),!0;if(!t.P){var s=D(d(t),e),i=null==s?void 0:s[z];if(i&&i.t===r)return t.o[e]=r,t.D[e]=!1,!0;if(h(r,s)&&(void 0!==r||c(t.t,e)))return!0;C(t),N(t)}return t.o[e]===r&&"number"!=typeof r&&(void 0!==r||e in t.o)||(t.o[e]=r,t.D[e]=!0,!0)},deleteProperty:function(t,e){return void 0!==D(t.t,e)||e in t.t?(t.D[e]=!1,C(t),N(t)):delete t.D[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var r=d(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n?{writable:!0,configurable:1!==t.i||"length"!==e,enumerable:n.enumerable,value:r[e]}:n},defineProperty:function(){n(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){n(12)}},Z={};o(W,(function(t,e){Z[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),Z.deleteProperty=function(t,e){return Z.set.call(this,t,e,void 0)},Z.set=function(t,e,r){return W.set.call(this,t[0],e,r,t[0])};var X=function(){function t(t){var e=this;this.g=$,this.F=!0,this.produce=function(t,r,s){if("function"==typeof t&&"function"!=typeof r){var o=r;r=t;var a=e;return function(t){var e=this;void 0===t&&(t=o);for(var n=arguments.length,s=Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return a.produce(t,(function(t){var n;return(n=r).call.apply(n,[e,t].concat(s))}))}}var c;if("function"!=typeof r&&n(6),void 0!==s&&"function"!=typeof s&&n(7),i(t)){var u=_(e),l=T(e,t,void 0),h=!0;try{c=r(l),h=!1}finally{h?P(u):I(u)}return"undefined"!=typeof Promise&&c instanceof Promise?c.then((function(t){return E(u,s),S(t,u)}),(function(t){throw P(u),t})):(E(u,s),S(c,u))}if(!t||"object"!=typeof t){if(void 0===(c=r(t))&&(c=t),c===q&&(c=void 0),e.F&&m(c,!0),s){var p=[],f=[];b("Patches").M(t,c,p,f),s(p,f)}return c}n(21,t)},this.produceWithPatches=function(t,r){if("function"==typeof t)return function(r){for(var n=arguments.length,s=Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return e.produceWithPatches(r,(function(e){return t.apply(void 0,[e].concat(s))}))};var n,s,i=e.produce(t,r,(function(t,e){n=t,s=e}));return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(t){return[t,n,s]})):[i,n,s]},"boolean"==typeof(null==t?void 0:t.useProxies)&&this.setUseProxies(t.useProxies),"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze)}var e=t.prototype;return e.createDraft=function(t){i(t)||n(8),s(t)&&(t=j(t));var e=_(this),r=T(this,t,void 0);return r[z].C=!0,I(e),r},e.finishDraft=function(t,e){var r=(t&&t[z]).A;return E(r,e),S(void 0,r)},e.setAutoFreeze=function(t){this.F=t},e.setUseProxies=function(t){t&&!$&&n(20),this.g=t},e.applyPatches=function(t,e){var r;for(r=e.length-1;r>=0;r--){var n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}r>-1&&(e=e.slice(r+1));var i=b("Patches").$;return s(t)?i(t,e):this.produce(t,(function(t){return i(t,e)}))},t}(),Q=new X,tt=Q.produce,et=(Q.produceWithPatches.bind(Q),Q.setAutoFreeze.bind(Q),Q.setUseProxies.bind(Q),Q.applyPatches.bind(Q),Q.createDraft.bind(Q),Q.finishDraft.bind(Q),tt),rt=r(4460);r(3261);const nt="MAKE_MOVE",st="GAME_EVENT",it="REDO",ot="RESET",at="SYNC",ct="UNDO",ut="UPDATE",lt="PATCH",ht="PLUGIN",pt="STRIP_TRANSIENTS",ft=(t,e,r,n)=>({type:nt,payload:{type:t,args:e,playerID:r,credentials:n}}),dt=(t,e,r,n)=>({type:st,payload:{type:t,args:e,playerID:r,credentials:n}}),yt=(t,e,r,n)=>({type:st,payload:{type:t,args:e,playerID:r,credentials:n},automatic:!0}),mt=t=>({type:at,state:t.state,log:t.log,initialState:t.initialState,clientOnly:!0}),gt=(t,e,r,n)=>({type:lt,prevStateID:t,stateID:e,patch:r,deltalog:n,clientOnly:!0}),vt=(t,e)=>({type:ut,state:t,deltalog:e,clientOnly:!0}),bt=t=>({type:ot,state:t,clientOnly:!0}),wt=(t,e)=>({type:ct,payload:{type:null,args:null,playerID:t,credentials:e}}),Et=(t,e)=>({type:it,payload:{type:null,args:null,playerID:t,credentials:e}}),Pt=()=>({type:pt});var It=Object.freeze({__proto__:null,makeMove:ft,gameEvent:dt,automaticGameEvent:yt,sync:mt,patch:gt,update:vt,reset:bt,undo:wt,redo:Et,plugin:(t,e,r,n)=>({type:ht,payload:{type:t,args:e,playerID:r,credentials:n}}),stripTransients:Pt});const _t="INVALID_MOVE",Ot={name:"plugin-immer",fnWrap:t=>(e,r,...n)=>{let s=!1;const i=et(e,(e=>{const i=t(e,r,...n);if(i!==_t)return i;s=!0}));return s?_t:i}};var St,xt;!function(t){t.MOVE="MOVE",t.GAME_ON_END="GAME_ON_END",t.PHASE_ON_BEGIN="PHASE_ON_BEGIN",t.PHASE_ON_END="PHASE_ON_END",t.TURN_ON_BEGIN="TURN_ON_BEGIN",t.TURN_ON_MOVE="TURN_ON_MOVE",t.TURN_ON_END="TURN_ON_END"}(St||(St={})),function(t){t.CalledOutsideHook="Events must be called from moves or the `onBegin`, `onEnd`, and `onMove` hooks.\nThis error probably means you called an event from other game code, like an `endIf` trigger or one of the `turn.order` methods.",t.EndTurnInOnEnd="`endTurn` is disallowed in `onEnd` hooks \u2014 the turn is already ending.",t.MaxTurnEndings="Maximum number of turn endings exceeded for this update.\nThis likely means game code is triggering an infinite loop.",t.PhaseEventInOnEnd="`setPhase` & `endPhase` are disallowed in a phase\u2019s `onEnd` hook \u2014 the phase is already ending.\nIf you\u2019re trying to dynamically choose the next phase when a phase ends, use the phase\u2019s `next` trigger.",t.StageEventInOnEnd="`setStage`, `endStage` & `setActivePlayers` are disallowed in `onEnd` hooks.",t.StageEventInPhaseBegin="`setStage`, `endStage` & `setActivePlayers` are disallowed in a phase\u2019s `onBegin` hook.\nUse `setActivePlayers` in a `turn.onBegin` hook or declare stages with `turn.activePlayers` instead.",t.StageEventInTurnBegin="`setStage` & `endStage` are disallowed in `turn.onBegin`.\nUse `setActivePlayers` or declare stages with `turn.activePlayers` instead."}(xt||(xt={}));class At{constructor(t,e,r){this.flow=t,this.playerID=r,this.dispatch=[],this.initialTurn=e.turn,this.updateTurnContext(e,void 0),this.maxEndedTurnsPerAction=100*e.numPlayers}api(){const t={_private:this};for(const e of this.flow.eventNames)t[e]=(...t)=>{this.dispatch.push({type:e,args:t,phase:this.currentPhase,turn:this.currentTurn,calledFrom:this.currentMethod,error:new Error("Events Plugin Error")})};return t}isUsed(){return this.dispatch.length>0}updateTurnContext(t,e){this.currentPhase=t.phase,this.currentTurn=t.turn,this.currentMethod=e}unsetCurrentMethod(){this.currentMethod=void 0}update(t){const e=t,r=({stack:t},r)=>({...e,plugins:{...e.plugins,events:{...e.plugins.events,data:{error:r+"\n"+t}}}});t:for(let n=0;n<this.dispatch.length;n++){const e=this.dispatch[n],s=e.turn!==t.ctx.turn;if(this.currentTurn-this.initialTurn>=this.maxEndedTurnsPerAction)return r(e.error,xt.MaxTurnEndings);if(void 0===e.calledFrom)return r(e.error,xt.CalledOutsideHook);if(t.ctx.gameover)break t;switch(e.type){case"endStage":case"setStage":case"setActivePlayers":switch(e.calledFrom){case St.TURN_ON_END:case St.PHASE_ON_END:return r(e.error,xt.StageEventInOnEnd);case St.PHASE_ON_BEGIN:return r(e.error,xt.StageEventInPhaseBegin);case St.TURN_ON_BEGIN:if("setActivePlayers"===e.type)break;return r(e.error,xt.StageEventInTurnBegin)}if(s)continue t;break;case"endTurn":if(e.calledFrom===St.TURN_ON_END||e.calledFrom===St.PHASE_ON_END)return r(e.error,xt.EndTurnInOnEnd);if(s)continue t;break;case"endPhase":case"setPhase":if(e.calledFrom===St.PHASE_ON_END)return r(e.error,xt.PhaseEventInOnEnd);if(e.phase!==t.ctx.phase)continue t}const i=yt(e.type,e.args,this.playerID);t=this.flow.processEvent(t,i)}return t}}const kt={name:"events",noClient:({api:t})=>t._private.isUsed(),isInvalid:({data:t})=>t.error||!1,fnWrap:(t,e)=>(r,n,...s)=>{const i=n.events;return i&&i._private.updateTurnContext(n,e),r=t(r,n,...s),i&&i._private.unsetCurrentMethod(),r},dangerouslyFlushRawState:({state:t,api:e})=>e._private.update(t),api:({game:t,ctx:e,playerID:r})=>new At(t.flow,e,r).api()};const Dt=()=>{};function Mt(t){Dt(`INFO: ${t}`)}function Nt(t){((...t)=>{console.error(...t)})("ERROR:",t)}const Ct=[Ot,rt.R,{name:"log",flush:()=>({}),api:({data:t})=>({setMetadata:e=>{t.metadata=e}}),setup:()=>({})},{name:"plugin-serializable",fnWrap:t=>(e,r,...n)=>t(e,r,...n)}],Tt=[...Ct,kt],jt=(t,e,r)=>(r.game.plugins.filter((t=>void 0!==t.action)).filter((t=>t.name===e.payload.type)).forEach((r=>{const n=r.name,s=t.plugins[n]||{data:{}},i=r.action(s.data,e.payload);t={...t,plugins:{...t.plugins,[n]:{...s,data:i}}}})),t),Rt=t=>{const e={...t.ctx},r=t.plugins||{};return Object.entries(r).forEach((([t,{api:r}])=>{e[t]=r})),e},Bt=(t,e,r)=>[...Ct,...r,kt].filter((t=>void 0!==t.fnWrap)).reduce(((t,{fnWrap:r})=>r(t,e)),t),Lt=(t,e)=>([...Tt,...e.game.plugins].filter((t=>void 0!==t.setup)).forEach((r=>{const n=r.name,s=r.setup({G:t.G,ctx:t.ctx,game:e.game});t={...t,plugins:{...t.plugins,[n]:{data:s}}}})),t),Ut=(t,e)=>([...Tt,...e.game.plugins].filter((t=>void 0!==t.api)).forEach((r=>{const n=r.name,s=t.plugins[n]||{data:{}},i=r.api({G:t.G,ctx:t.ctx,data:s.data,game:e.game,playerID:e.playerID});t={...t,plugins:{...t.plugins,[n]:{...s,api:i}}}})),t),Gt=(t,e)=>[...Tt,...e.game.plugins].filter((t=>void 0!==t.noClient)).map((r=>{const n=r.name,s=t.plugins[n];return!!s&&r.noClient({G:t.G,ctx:t.ctx,game:e.game,api:s.api,data:s.data})})).includes(!0),Ft=(t,e)=>{const r=((t,e)=>([...Ct,...e.game.plugins,kt].reverse().forEach((r=>{const n=r.name,s=t.plugins[n]||{data:{}};if(r.flush){const n=r.flush({G:t.G,ctx:t.ctx,game:e.game,api:s.api,data:s.data});t={...t,plugins:{...t.plugins,[r.name]:{data:n}}}}else if(r.dangerouslyFlushRawState){const i=(t=r.dangerouslyFlushRawState({state:t,game:e.game,api:s.api,data:s.data})).plugins[n].data;t={...t,plugins:{...t.plugins,[r.name]:{data:i}}}}})),t))(t,e),n=((t,e)=>[...Tt,...e.game.plugins].filter((t=>void 0!==t.isInvalid)).map((r=>{const{name:n}=r,s=t.plugins[n],i=r.isInvalid({G:t.G,ctx:t.ctx,game:e.game,data:s&&s.data});return!!i&&{plugin:n,message:i}})).find((t=>t))||!1)(r,e);if(!n)return[r];const{plugin:s,message:i}=n;return Nt(`${s} plugin declared action invalid:\n${i}`),[t,n]},$t=({G:t,ctx:e,plugins:r={}},{game:n,playerID:s})=>([...Tt,...n.plugins].forEach((({name:i,playerView:o})=>{if(!o)return;const{data:a}=r[i]||{data:{}},c=o({G:t,ctx:e,game:n,data:a,playerID:s});r={...r,[i]:{data:c}}})),r);function qt(t,e=!1){t.moveLimit&&(e&&(t.minMoves=t.moveLimit),t.maxMoves=t.moveLimit,delete t.moveLimit)}function Vt(t,e){let r={},n=[],s=null,i={},o={};if(Array.isArray(e)){const t={};e.forEach((e=>t[e]=Zt.NULL)),r=t}else{if(qt(e),e.next&&(s=e.next),e.revert&&(n=[...t._prevActivePlayers,{activePlayers:t.activePlayers,_activePlayersMinMoves:t._activePlayersMinMoves,_activePlayersMaxMoves:t._activePlayersMaxMoves,_activePlayersNumMoves:t._activePlayersNumMoves}]),void 0!==e.currentPlayer&&Jt(r,i,o,t.currentPlayer,e.currentPlayer),void 0!==e.others)for(let n=0;n<t.playOrder.length;n++){const s=t.playOrder[n];s!==t.currentPlayer&&Jt(r,i,o,s,e.others)}if(void 0!==e.all)for(let n=0;n<t.playOrder.length;n++){Jt(r,i,o,t.playOrder[n],e.all)}if(e.value)for(const t in e.value)Jt(r,i,o,t,e.value[t]);if(e.minMoves)for(const t in r)void 0===i[t]&&(i[t]=e.minMoves);if(e.maxMoves)for(const t in r)void 0===o[t]&&(o[t]=e.maxMoves)}0===Object.keys(r).length&&(r=null),0===Object.keys(i).length&&(i=null),0===Object.keys(o).length&&(o=null);const a={};for(const c in r)a[c]=0;return{...t,activePlayers:r,_activePlayersMinMoves:i,_activePlayersMaxMoves:o,_activePlayersNumMoves:a,_prevActivePlayers:n,_nextActivePlayers:s}}function zt(t){let{activePlayers:e,_activePlayersMinMoves:r,_activePlayersMaxMoves:n,_activePlayersNumMoves:s,_prevActivePlayers:i,_nextActivePlayers:o}=t;if(e&&0===Object.keys(e).length)if(o)t=Vt(t,o),({activePlayers:e,_activePlayersMinMoves:r,_activePlayersMaxMoves:n,_activePlayersNumMoves:s,_prevActivePlayers:i}=t);else if(i.length>0){const t=i.length-1;({activePlayers:e,_activePlayersMinMoves:r,_activePlayersMaxMoves:n,_activePlayersNumMoves:s}=i[t]),i=i.slice(0,t)}else e=null,r=null,n=null;return{...t,activePlayers:e,_activePlayersMinMoves:r,_activePlayersMaxMoves:n,_activePlayersNumMoves:s,_prevActivePlayers:i}}function Jt(t,e,r,n,s){"object"===typeof s&&s!==Zt.NULL||(s={stage:s}),void 0!==s.stage&&(qt(s),t[n]=s.stage,s.minMoves&&(e[n]=s.minMoves),s.maxMoves&&(r[n]=s.maxMoves))}function Kt(t,e){return t[e]+""}function Ht(t,e){let{G:r,ctx:n}=t;const{numPlayers:s}=n,i=Rt(t),o=e.order;let a=[...Array.from({length:s})].map(((t,e)=>e+""));void 0!==o.playOrder&&(a=o.playOrder(r,i));const c=o.first(r,i),u=typeof c;"number"!==u&&Nt(`invalid value returned by turn.order.first \u2014 expected number got ${u} \u201c${c}\u201d.`);const l=Kt(a,c);return n={...n,currentPlayer:l,playOrderPos:c,playOrder:a},n=Vt(n,e.activePlayers||{}),n}function Yt(t,e,r,n){const s=r.order;let{G:i,ctx:o}=t,a=o.playOrderPos,c=!1;if(n&&!0!==n)"object"!==typeof n&&Nt(`invalid argument to endTurn: ${n}`),Object.keys(n).forEach((t=>{switch(t){case"remove":e=Kt(o.playOrder,a);break;case"next":a=o.playOrder.indexOf(n.next),e=n.next;break;default:Nt(`invalid argument to endTurn: ${t}`)}}));else{const r=Rt(t),n=s.next(i,r),u=typeof n;void 0!==n&&"number"!==u&&Nt(`invalid value returned by turn.order.next \u2014 expected number or undefined got ${u} \u201c${n}\u201d.`),void 0===n?c=!0:(a=n,e=Kt(o.playOrder,a))}return o={...o,playOrderPos:a,currentPlayer:e},{endPhase:c,ctx:o}}const Wt={DEFAULT:{first:(t,e)=>0===e.turn?e.playOrderPos:(e.playOrderPos+1)%e.playOrder.length,next:(t,e)=>(e.playOrderPos+1)%e.playOrder.length},RESET:{first:()=>0,next:(t,e)=>(e.playOrderPos+1)%e.playOrder.length},CONTINUE:{first:(t,e)=>e.playOrderPos,next:(t,e)=>(e.playOrderPos+1)%e.playOrder.length},ONCE:{first:()=>0,next:(t,e)=>{if(e.playOrderPos<e.playOrder.length-1)return e.playOrderPos+1}},CUSTOM:t=>({playOrder:()=>t,first:()=>0,next:(t,e)=>(e.playOrderPos+1)%e.playOrder.length}),CUSTOM_FROM:t=>({playOrder:e=>e[t],first:()=>0,next:(t,e)=>(e.playOrderPos+1)%e.playOrder.length})},Zt={NULL:null};Zt.NULL,Zt.NULL,Zt.NULL,Zt.NULL},4275:function(t,e){"use strict";e.E=function(){var t=[],e=t;function r(){e===t&&(e=t.slice())}return{listen:function(t){if("function"!==typeof t)throw new Error("Expected listener to be a function.");var n=!0;return r(),e.push(t),function(){if(n){n=!1,r();var s=e.indexOf(t);e.splice(s,1)}}},emit:function(){for(var r=t=e,n=0;n<r.length;n++)r[n].apply(r,arguments)}}}},4366:function(t){"use strict";var e=Object.prototype.hasOwnProperty;function r(t,e){return t===e?0!==t||0!==e||1/t===1/e:t!==t&&e!==e}t.exports=function(t,n){if(r(t,n))return!0;if("object"!==typeof t||null===t||"object"!==typeof n||null===n)return!1;var s=Object.keys(t),i=Object.keys(n);if(s.length!==i.length)return!1;for(var o=0;o<s.length;o++)if(!e.call(n,s[o])||!r(t[s[o]],n[s[o]]))return!1;return!0}},3261:function(t){var e,r,n=Function.prototype,s=Object.prototype,i=n.toString,o=s.hasOwnProperty,a=i.call(Object),c=s.toString,u=(e=Object.getPrototypeOf,r=Object,function(t){return e(r(t))});t.exports=function(t){if(!function(t){return!!t&&"object"==typeof t}(t)||"[object Object]"!=c.call(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(r){}return e}(t))return!1;var e=u(t);if(null===e)return!0;var r=o.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&i.call(r)==a}},6493:function(t){"use strict";var e=Object.assign.bind(Object);t.exports=e,t.exports.default=t.exports},4284:function(t,e,r){"use strict";var n,s;t.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"===typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(6118)},2241:function(t){!function(){var e={449:function(t,e){"use strict";e.byteLength=function(t){var e=c(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,i=c(t),o=i[0],a=i[1],u=new s(function(t,e,r){return 3*(e+r)/4-r}(0,o,a)),l=0,h=a>0?o-4:o;for(r=0;r<h;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===a&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,u[l++]=255&e);1===a&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,s=n%3,i=[],o=16383,a=0,c=n-s;a<c;a+=o)i.push(l(t,a,a+o>c?c:a+o));1===s?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===s&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],n=[],s="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=i.length;o<a;++o)r[o]=i[o],n[i.charCodeAt(o)]=o;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function u(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function l(t,e,r){for(var n,s=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),s.push(u(n));return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},877:function(t,e,r){"use strict";var n=r(449),s=r(543),i="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50;var o=2147483647;function a(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,r){if("number"===typeof t){if("string"===typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,r)}function u(t,e,r){if("string"===typeof t)return function(t,e){"string"===typeof e&&""!==e||(e="utf8");if(!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|y(t,e),n=a(r),s=n.write(t,e);s!==r&&(n=n.slice(0,s));return n}(t,e);if(ArrayBuffer.isView(t))return p(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if($(t,ArrayBuffer)||t&&$(t.buffer,ArrayBuffer))return f(t,e,r);if("undefined"!==typeof SharedArrayBuffer&&($(t,SharedArrayBuffer)||t&&$(t.buffer,SharedArrayBuffer)))return f(t,e,r);if("number"===typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return c.from(n,e,r);var s=function(t){if(c.isBuffer(t)){var e=0|d(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!==typeof t.length||q(t.length)?a(0):p(t);if("Buffer"===t.type&&Array.isArray(t.data))return p(t.data)}(t);if(s)return s;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function l(t){if("number"!==typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return l(t),a(t<0?0:0|d(t))}function p(t){for(var e=t.length<0?0:0|d(t.length),r=a(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function f(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,c.prototype),n}function d(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function y(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||$(t,ArrayBuffer))return t.byteLength;if("string"!==typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var s=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(t).length;default:if(s)return n?-1:U(t).length;e=(""+e).toLowerCase(),s=!0}}function m(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return M(this,e,r);case"utf8":case"utf-8":return x(this,e,r);case"ascii":return k(this,e,r);case"latin1":case"binary":return D(this,e,r);case"base64":return S(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function v(t,e,r,n,s){if(0===t.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),q(r=+r)&&(r=s?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(s)return-1;r=t.length-1}else if(r<0){if(!s)return-1;r=0}if("string"===typeof e&&(e=c.from(e,n)),c.isBuffer(e))return 0===e.length?-1:b(t,e,r,n,s);if("number"===typeof e)return e&=255,"function"===typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):b(t,[e],r,n,s);throw new TypeError("val must be string, number or Buffer")}function b(t,e,r,n,s){var i,o=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(s){var l=-1;for(i=r;i<a;i++)if(u(t,i)===u(e,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*o}else-1!==l&&(i-=i-l),l=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){for(var h=!0,p=0;p<c;p++)if(u(t,i+p)!==u(e,p)){h=!1;break}if(h)return i}return-1}function w(t,e,r,n){r=Number(r)||0;var s=t.length-r;n?(n=Number(n))>s&&(n=s):n=s;var i=e.length;n>i/2&&(n=i/2);for(var o=0;o<n;++o){var a=parseInt(e.substr(2*o,2),16);if(q(a))return o;t[r+o]=a}return o}function E(t,e,r,n){return F(U(e,t.length-r),t,r,n)}function P(t,e,r,n){return F(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function I(t,e,r,n){return P(t,e,r,n)}function _(t,e,r,n){return F(G(e),t,r,n)}function O(t,e,r,n){return F(function(t,e){for(var r,n,s,i=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,s=r%256,i.push(s),i.push(n);return i}(e,t.length-r),t,r,n)}function S(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function x(t,e,r){r=Math.min(t.length,r);for(var n=[],s=e;s<r;){var i,o,a,c,u=t[s],l=null,h=u>239?4:u>223?3:u>191?2:1;if(s+h<=r)switch(h){case 1:u<128&&(l=u);break;case 2:128===(192&(i=t[s+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=t[s+1],o=t[s+2],128===(192&i)&&128===(192&o)&&(c=(15&u)<<12|(63&i)<<6|63&o)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=t[s+1],o=t[s+2],a=t[s+3],128===(192&i)&&128===(192&o)&&128===(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),s+=h}return A(n)}e.kMaxLength=o,c.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,r){return function(t,e,r){return l(t),t<=0?a(t):void 0!==e?"string"===typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},c.allocUnsafe=function(t){return h(t)},c.allocUnsafeSlow=function(t){return h(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if($(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),$(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,s=0,i=Math.min(r,n);s<i;++s)if(t[s]!==e[s]){r=t[s],n=e[s];break}return r<n?-1:n<r?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=c.allocUnsafe(e),s=0;for(r=0;r<t.length;++r){var i=t[r];if($(i,Uint8Array)&&(i=c.from(i)),!c.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,s),s+=i.length}return n},c.byteLength=y,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},c.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?x(this,0,t):m.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},i&&(c.prototype[i]=c.prototype.inspect),c.prototype.compare=function(t,e,r,n,s){if($(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),e<0||r>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=r)return 0;if(n>=s)return-1;if(e>=r)return 1;if(this===t)return 0;for(var i=(s>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0),a=Math.min(i,o),u=this.slice(n,s),l=t.slice(e,r),h=0;h<a;++h)if(u[h]!==l[h]){i=u[h],o=l[h];break}return i<o?-1:o<i?1:0},c.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},c.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},c.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},c.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"===typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var s=this.length-e;if((void 0===r||r>s)&&(r=s),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return w(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":return P(this,t,e,r);case"latin1":case"binary":return I(this,t,e,r);case"base64":return _(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return r}function k(t,e,r){var n="";r=Math.min(t.length,r);for(var s=e;s<r;++s)n+=String.fromCharCode(127&t[s]);return n}function D(t,e,r){var n="";r=Math.min(t.length,r);for(var s=e;s<r;++s)n+=String.fromCharCode(t[s]);return n}function M(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var s="",i=e;i<r;++i)s+=V[t[i]];return s}function N(t,e,r){for(var n=t.slice(e,r),s="",i=0;i<n.length;i+=2)s+=String.fromCharCode(n[i]+256*n[i+1]);return s}function C(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,r,n,s,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function j(t,e,r,n,s,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function R(t,e,r,n,i){return e=+e,r>>>=0,i||j(t,0,r,4),s.write(t,e,r,n,23,4),r+4}function B(t,e,r,n,i){return e=+e,r>>>=0,i||j(t,0,r,8),s.write(t,e,r,n,52,8),r+8}c.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);for(var n=this[t],s=1,i=0;++i<e&&(s*=256);)n+=this[t+i]*s;return n},c.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);for(var n=this[t+--e],s=1;e>0&&(s*=256);)n+=this[t+--e]*s;return n},c.prototype.readUInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);for(var n=this[t],s=1,i=0;++i<e&&(s*=256);)n+=this[t+i]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*e)),n},c.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);for(var n=e,s=1,i=this[t+--n];n>0&&(s*=256);)i+=this[t+--n]*s;return i>=(s*=128)&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||C(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(t,e){t>>>=0,e||C(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return t>>>=0,e||C(t,4,this.length),s.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||C(t,4,this.length),s.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||C(t,8,this.length),s.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||C(t,8,this.length),s.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||T(this,t,e,r,Math.pow(2,8*r)-1,0);var s=1,i=0;for(this[e]=255&t;++i<r&&(s*=256);)this[e+i]=t/s&255;return e+r},c.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||T(this,t,e,r,Math.pow(2,8*r)-1,0);var s=r-1,i=1;for(this[e+s]=255&t;--s>=0&&(i*=256);)this[e+s]=t/i&255;return e+r},c.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var s=Math.pow(2,8*r-1);T(this,t,e,r,s-1,-s)}var i=0,o=1,a=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/o>>0)-a&255;return e+r},c.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var s=Math.pow(2,8*r-1);T(this,t,e,r,s-1,-s)}var i=r-1,o=1,a=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/o>>0)-a&255;return e+r},c.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeFloatLE=function(t,e,r){return R(this,t,e,!0,r)},c.prototype.writeFloatBE=function(t,e,r){return R(this,t,e,!1,r)},c.prototype.writeDoubleLE=function(t,e,r){return B(this,t,e,!0,r)},c.prototype.writeDoubleBE=function(t,e,r){return B(this,t,e,!1,r)},c.prototype.copy=function(t,e,r,n){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var s=n-r;if(this===t&&"function"===typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,n);else if(this===t&&r<e&&e<n)for(var i=s-1;i>=0;--i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,n),e);return s},c.prototype.fill=function(t,e,r,n){if("string"===typeof t){if("string"===typeof e?(n=e,e=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var s=t.charCodeAt(0);("utf8"===n&&s<128||"latin1"===n)&&(t=s)}}else"number"===typeof t?t&=255:"boolean"===typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"===typeof t)for(i=e;i<r;++i)this[i]=t;else{var o=c.isBuffer(t)?t:c.from(t,n),a=o.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=o[i%a]}return this};var L=/[^+/0-9A-Za-z-_]/g;function U(t,e){var r;e=e||1/0;for(var n=t.length,s=null,i=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!s){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(e-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function G(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;t.length%4!==0;)t+="=";return t}(t))}function F(t,e,r,n){for(var s=0;s<n&&!(s+r>=e.length||s>=t.length);++s)e[s+r]=t[s];return s}function $(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function q(t){return t!==t}var V=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,s=0;s<16;++s)e[n+s]=t[r]+t[s];return e}()},543:function(t,e){e.read=function(t,e,r,n,s){var i,o,a=8*s-n-1,c=(1<<a)-1,u=c>>1,l=-7,h=r?s-1:0,p=r?-1:1,f=t[e+h];for(h+=p,i=f&(1<<-l)-1,f>>=-l,l+=a;l>0;i=256*i+t[e+h],h+=p,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=n;l>0;o=256*o+t[e+h],h+=p,l-=8);if(0===i)i=1-u;else{if(i===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),i-=u}return(f?-1:1)*o*Math.pow(2,i-n)},e.write=function(t,e,r,n,s,i){var o,a,c,u=8*i-s-1,l=(1<<u)-1,h=l>>1,p=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,d=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+h>=1?p/c:p*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=l?(a=0,o=l):o+h>=1?(a=(e*c-1)*Math.pow(2,s),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;t[r+f]=255&a,f+=d,a/=256,s-=8);for(o=o<<s|a,u+=s;u>0;t[r+f]=255&o,f+=d,o/=256,u-=8);t[r+f-d]|=128*y}}},r={};function n(t){var s=r[t];if(void 0!==s)return s.exports;var i=r[t]={exports:{}},o=!0;try{e[t](i,i.exports,n),o=!1}finally{o&&delete r[t]}return i.exports}n.ab="//";var s=n(877);t.exports=s}()},6118:function(t){!function(){var e={308:function(t){var e,r,n=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(e===setTimeout)return setTimeout(t,0);if((e===s||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"===typeof setTimeout?setTimeout:s}catch(t){e=s}try{r="function"===typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var a,c=[],u=!1,l=-1;function h(){u&&a&&(u=!1,a.length?c=a.concat(c):l=-1,c.length&&p())}function p(){if(!u){var t=o(h);u=!0;for(var e=c.length;e;){for(a=c,c=[];++l<e;)a&&a[l].run();l=-1,e=c.length}a=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function d(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new f(t,e)),1!==c.length||u||o(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=d,n.addListener=d,n.once=d,n.off=d,n.removeListener=d,n.removeAllListeners=d,n.emit=d,n.prependListener=d,n.prependOnceListener=d,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function n(t){var s=r[t];if(void 0!==s)return s.exports;var i=r[t]={exports:{}},o=!0;try{e[t](i,i.exports,n),o=!1}finally{o&&delete r[t]}return i.exports}n.ab="//";var s=n(308);t.exports=s}()},9382:function(t,e,r){var n=r(4284);!function(){var e={66:function(){!function(t,e){"use strict";if(!t.setImmediate){var r,s=1,i={},o=!1,a=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?r=function(t){n.nextTick((function(){h(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(r){r.source===t&&"string"===typeof r.data&&0===r.data.indexOf(e)&&h(+r.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),r=function(r){t.postMessage(e+r,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){h(t.data)},r=function(e){t.port2.postMessage(e)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var t=a.documentElement;r=function(e){var r=a.createElement("script");r.onreadystatechange=function(){h(e),r.onreadystatechange=null,t.removeChild(r),r=null},t.appendChild(r)}}():r=function(t){setTimeout(h,0,t)},c.setImmediate=function(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var o={callback:t,args:e};return i[s]=o,r(s),s++},c.clearImmediate=u}function u(t){delete i[t]}function l(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(undefined,r)}}function h(t){if(o)setTimeout(h,0,t);else{var e=i[t];if(e){o=!0;try{l(e)}finally{u(t),o=!1}}}}}("undefined"===typeof self?"undefined"===typeof r.g?this:r.g:self)}};"undefined"!==typeof __nccwpck_require__&&(__nccwpck_require__.ab="//");e[66](),t.exports={}}()},1877:function(t,e,r){"use strict";var n=r(4284);var s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var i=a(r(8292)),o=a(r(6493));function a(t){return t&&t.__esModule?t:{default:t}}var c="undefined"===typeof document||"undefined"!==typeof n&&n.env&&!1,u={},l=void 0;function h(){return l&&!l.headersSent}function p(t,e){var r=c?u:i.default.parse(document.cookie),n=r&&r[t];if("undefined"===typeof e&&(e=!n||"{"!==n[0]&&"["!==n[0]),!e)try{n=JSON.parse(n)}catch(s){}return n}function f(t){var e=c?u:i.default.parse(document.cookie);if("undefined"===typeof t&&(t=!e||"{"!==e[0]&&"["!==e[0]),!t)try{e=JSON.parse(e)}catch(r){}return e}function d(t){var e=c?u:i.default.parse(document.cookie);return e?t?Object.keys(e).reduce((function(r,n){if(!t.test(n))return r;var s={};return s[n]=e[n],(0,o.default)({},r,s)}),{}):e:{}}function y(t,e,r){u[t]=e,"object"===("undefined"===typeof e?"undefined":s(e))&&(u[t]=JSON.stringify(e)),c||(document.cookie=i.default.serialize(t,u[t],r)),h()&&l.cookie&&l.cookie(t,e,r)}function m(t,e){delete u[t],e="undefined"===typeof e?{}:"string"===typeof e?{path:e}:(0,o.default)({},e),"undefined"!==typeof document&&(e.expires=new Date(1970,1,1,0,0,1),e.maxAge=0,document.cookie=i.default.serialize(t,"",e)),h()&&l.clearCookie&&l.clearCookie(t,e)}function g(t){u=t?i.default.parse(t):{}}function v(t,e){return t.cookie?u=t.cookie:t.cookies?u=t.cookies:t.headers&&t.headers.cookie?g(t.headers.cookie):u={},l=e,function(){l=null,u={}}}e.ZP={setRawCookie:g,load:p,loadAll:f,select:d,save:y,remove:m,plugToRequest:v}},8292:function(t,e){"use strict";e.parse=function(t,e){if("string"!==typeof t)throw new TypeError("argument str must be a string");for(var n={},i=e||{},a=t.split(s),c=i.decode||r,u=0;u<a.length;u++){var l=a[u],h=l.indexOf("=");if(!(h<0)){var p=l.substr(0,h).trim(),f=l.substr(++h,l.length).trim();'"'==f[0]&&(f=f.slice(1,-1)),void 0==n[p]&&(n[p]=o(f,c))}}return n},e.serialize=function(t,e,r){var s=r||{},o=s.encode||n;if("function"!==typeof o)throw new TypeError("option encode is invalid");if(!i.test(t))throw new TypeError("argument name is invalid");var a=o(e);if(a&&!i.test(a))throw new TypeError("argument val is invalid");var c=t+"="+a;if(null!=s.maxAge){var u=s.maxAge-0;if(isNaN(u))throw new Error("maxAge should be a Number");c+="; Max-Age="+Math.floor(u)}if(s.domain){if(!i.test(s.domain))throw new TypeError("option domain is invalid");c+="; Domain="+s.domain}if(s.path){if(!i.test(s.path))throw new TypeError("option path is invalid");c+="; Path="+s.path}if(s.expires){if("function"!==typeof s.expires.toUTCString)throw new TypeError("option expires is invalid");c+="; Expires="+s.expires.toUTCString()}s.httpOnly&&(c+="; HttpOnly");s.secure&&(c+="; Secure");if(s.sameSite){switch("string"===typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"strict":c+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return c};var r=decodeURIComponent,n=encodeURIComponent,s=/; */,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function o(t,e){try{return e(t)}catch(r){return t}}},4153:function(t,e,r){"use strict";r.d(e,{qC:function(){return f},hC:function(){return h}});var n=r(7378),s=(r(4366),r(3219));function i(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==t&&void 0!==t&&this.setState(t)}function o(t){this.setState(function(e){var r=this.constructor.getDerivedStateFromProps(t,e);return null!==r&&void 0!==r?r:null}.bind(this))}function a(t,e){try{var r=this.props,n=this.state;this.props=t,this.state=e,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}i.__suppressDeprecationWarning=!0,o.__suppressDeprecationWarning=!0,a.__suppressDeprecationWarning=!0;r(9599);var c=r(4275),u=r(4632),l=function(t,e){return function(r){return r[t]=e,r}},h=function(t){return l("displayName",t)};Object.keys,n.Component;var p,f=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}),(function(t){return t}))},d={fromESObservable:null,toESObservable:null},y={fromESObservable:function(t){return"function"===typeof d.fromESObservable?d.fromESObservable(t):t},toESObservable:function(t){return"function"===typeof d.toESObservable?d.toESObservable(t):t}};p=y},9599:function(t){"use strict";var e={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n=Object.defineProperty,s=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,o=Object.getOwnPropertyDescriptor,a=Object.getPrototypeOf,c=a&&a(Object);t.exports=function t(u,l,h){if("string"!==typeof l){if(c){var p=a(l);p&&p!==c&&t(u,p,h)}var f=s(l);i&&(f=f.concat(i(l)));for(var d=0;d<f.length;++d){var y=f[d];if(!e[y]&&!r[y]&&(!h||!h[y])){var m=o(l,y);try{n(u,y,m)}catch(g){}}}return u}return u}},5240:function(t,e,r){"use strict";r.d(e,{md:function(){return f},qC:function(){return p},MT:function(){return h}});var n=r(4649);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){(0,n.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var a="function"===typeof Symbol&&Symbol.observable||"@@observable",c=function(){return Math.random().toString(36).substring(7).split("").join(".")},u={INIT:"@@redux/INIT"+c(),REPLACE:"@@redux/REPLACE"+c(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+c()}};function l(t){if("object"!==typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function h(t,e,r){var n;if("function"===typeof e&&"function"===typeof r||"function"===typeof r&&"function"===typeof arguments[3])throw new Error(o(0));if("function"===typeof e&&"undefined"===typeof r&&(r=e,e=void 0),"undefined"!==typeof r){if("function"!==typeof r)throw new Error(o(1));return r(h)(t,e)}if("function"!==typeof t)throw new Error(o(2));var s=t,i=e,c=[],p=c,f=!1;function d(){p===c&&(p=c.slice())}function y(){if(f)throw new Error(o(3));return i}function m(t){if("function"!==typeof t)throw new Error(o(4));if(f)throw new Error(o(5));var e=!0;return d(),p.push(t),function(){if(e){if(f)throw new Error(o(6));e=!1,d();var r=p.indexOf(t);p.splice(r,1),c=null}}}function g(t){if(!l(t))throw new Error(o(7));if("undefined"===typeof t.type)throw new Error(o(8));if(f)throw new Error(o(9));try{f=!0,i=s(i,t)}finally{f=!1}for(var e=c=p,r=0;r<e.length;r++){(0,e[r])()}return t}function v(t){if("function"!==typeof t)throw new Error(o(10));s=t,g({type:u.REPLACE})}function b(){var t,e=m;return(t={subscribe:function(t){if("object"!==typeof t||null===t)throw new Error(o(11));function r(){t.next&&t.next(y())}return r(),{unsubscribe:e(r)}}})[a]=function(){return this},t}return g({type:u.INIT}),(n={dispatch:g,subscribe:m,getState:y,replaceReducer:v})[a]=b,n}function p(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}function f(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t){return function(){var r=t.apply(void 0,arguments),n=function(){throw new Error(o(15))},s={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},a=e.map((function(t){return t(s)}));return n=p.apply(void 0,a)(r.dispatch),i(i({},r),{},{dispatch:n})}}}},9040:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.diffAny=e.diffObjects=e.diffArrays=e.intersection=e.subtract=e.isDestructive=void 0;var n=r(99);function s(t,e){var r={};for(var s in t)n.hasOwnProperty.call(t,s)&&void 0!==t[s]&&(r[s]=1);for(var i in e)n.hasOwnProperty.call(e,i)&&void 0!==e[i]&&delete r[i];return Object.keys(r)}function i(t){for(var e=t.length,r={},s=0;s<e;s++){var i=t[s];for(var o in i)n.hasOwnProperty.call(i,o)&&void 0!==i[o]&&(r[o]=(r[o]||0)+1)}for(var o in r)r[o]<e&&delete r[o];return Object.keys(r)}function o(t,e){return{operations:t.operations.concat(e),cost:t.cost+1}}function a(t,e,r,n){void 0===n&&(n=u);var s={"0,0":{operations:[],cost:0}};var i=isNaN(t.length)||t.length<=0?0:t.length,a=isNaN(e.length)||e.length<=0?0:e.length,c=function i(a,c){var u=a+","+c,l=s[u];if(void 0===l){if(a>0&&c>0&&!n(t[a-1],e[c-1],r.add(String(a-1))).length)l=i(a-1,c-1);else{var h=[];if(a>0){var p=i(a-1,c),f={op:"remove",index:a-1};h.push(o(p,f))}if(c>0){var d=i(a,c-1),y={op:"add",index:a-1,value:e[c-1]};h.push(o(d,y))}if(a>0&&c>0){var m=i(a-1,c-1),g={op:"replace",index:a-1,original:t[a-1],value:e[c-1]};h.push(o(m,g))}l=h.sort((function(t,e){return t.cost-e.cost}))[0]}s[u]=l}return l}(i,a).operations;return c.reduce((function(t,e){var s=t[0],o=t[1];if(function(t){return"add"===t.op}(e)){var a=e.index+1+o,c=a<i+o?String(a):"-",u={op:e.op,path:r.add(c).toString(),value:e.value};return[s.concat(u),o+1]}if(function(t){return"remove"===t.op}(e)){u={op:e.op,path:r.add(String(e.index+o)).toString()};return[s.concat(u),o-1]}var l=r.add(String(e.index+o)),h=n(e.original,e.value,l);return[s.concat.apply(s,h),o]}),[[],0])[0]}function c(t,e,r,n){void 0===n&&(n=u);var o=[];return s(t,e).forEach((function(t){o.push({op:"remove",path:r.add(t).toString()})})),s(e,t).forEach((function(t){o.push({op:"add",path:r.add(t).toString(),value:e[t]})})),i([t,e]).forEach((function(s){o.push.apply(o,n(t[s],e[s],r.add(s)))})),o}function u(t,e,r,s){if(void 0===s&&(s=u),t===e)return[];var i=n.objectType(t),o=n.objectType(e);return"array"==i&&"array"==o?a(t,e,r,s):"object"==i&&"object"==o?c(t,e,r,s):[{op:"replace",path:r.toString(),value:e}]}e.isDestructive=function(t){var e=t.op;return"remove"===e||"replace"===e||"copy"===e||"move"===e},e.subtract=s,e.intersection=i,e.diffArrays=a,e.diffObjects=c,e.diffAny=u},3979:function(t,e,r){"use strict";e.rh=e.af=void 0;var n=r(2399),s=r(5064),i=r(9040);function o(t,e){var r=n.Pointer.fromJSON(e).evaluate(t);if(void 0!==r)return{op:"test",path:e,value:r.value}}e.af=function(t,e){return e.map((function(e){return s.apply(t,e)}))},e.rh=function(t,e,r){var s=new n.Pointer;return(r?function(t){return function e(r,n,s){var o=t(r,n,s);return Array.isArray(o)?o:i.diffAny(r,n,s,e)}}(r):i.diffAny)(t,e,s)}},5064:function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.apply=e.InvalidOperationError=e.test=e.copy=e.move=e.replace=e.remove=e.add=e.TestError=e.MissingError=void 0;var s=r(2399),i=r(99),o=r(9040),a=function(t){function e(e){var r=t.call(this,"Value required at path: "+e)||this;return r.path=e,r.name="MissingError",r}return n(e,t),e}(Error);e.MissingError=a;var c=function(t){function e(e,r){var n=t.call(this,"Test failed: "+e+" != "+r)||this;return n.actual=e,n.expected=r,n.name="TestError",n}return n(e,t),e}(Error);function u(t,e,r){if(Array.isArray(t))if("-"==e)t.push(r);else{var n=parseInt(e,10);t.splice(n,0,r)}else t[e]=r}function l(t,e){if(Array.isArray(t)){var r=parseInt(e,10);t.splice(r,1)}else delete t[e]}function h(t,e){var r=s.Pointer.fromJSON(e.path).evaluate(t);return void 0===r.parent?new a(e.path):(u(r.parent,r.key,i.clone(e.value)),null)}function p(t,e){var r=s.Pointer.fromJSON(e.path).evaluate(t);return void 0===r.value?new a(e.path):(l(r.parent,r.key),null)}function f(t,e){var r=s.Pointer.fromJSON(e.path).evaluate(t);if(null===r.parent)return new a(e.path);if(Array.isArray(r.parent)){if(parseInt(r.key,10)>=r.parent.length)return new a(e.path)}else if(void 0===r.value)return new a(e.path);return r.parent[r.key]=e.value,null}function d(t,e){var r=s.Pointer.fromJSON(e.from).evaluate(t);if(void 0===r.value)return new a(e.from);var n=s.Pointer.fromJSON(e.path).evaluate(t);return void 0===n.parent?new a(e.path):(l(r.parent,r.key),u(n.parent,n.key,r.value),null)}function y(t,e){var r=s.Pointer.fromJSON(e.from).evaluate(t);if(void 0===r.value)return new a(e.from);var n=s.Pointer.fromJSON(e.path).evaluate(t);return void 0===n.parent?new a(e.path):(u(n.parent,n.key,i.clone(r.value)),null)}function m(t,e){var r=s.Pointer.fromJSON(e.path).evaluate(t);return o.diffAny(r.value,e.value,new s.Pointer).length?new c(r.value,e.value):null}e.TestError=c,e.add=h,e.remove=p,e.replace=f,e.move=d,e.copy=y,e.test=m;var g=function(t){function e(e){var r=t.call(this,"Invalid operation: "+e.op)||this;return r.operation=e,r.name="InvalidOperationError",r}return n(e,t),e}(Error);e.InvalidOperationError=g,e.apply=function(t,e){switch(e.op){case"add":return h(t,e);case"remove":return p(t,e);case"replace":return f(t,e);case"move":return d(t,e);case"copy":return y(t,e);case"test":return m(t,e)}return new g(e)}},2399:function(t,e){"use strict";function r(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function n(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(e,"__esModule",{value:!0}),e.Pointer=void 0;var s=function(){function t(t){void 0===t&&(t=[""]),this.tokens=t}return t.fromJSON=function(e){var n=e.split("/").map(r);if(""!==n[0])throw new Error("Invalid JSON Pointer: "+e);return new t(n)},t.prototype.toString=function(){return this.tokens.map(n).join("/")},t.prototype.evaluate=function(t){for(var e=null,r="",n=t,s=1,i=this.tokens.length;s<i;s++)e=n,"__proto__"!=(r=this.tokens[s])&&"constructor"!=r&&"prototype"!=r&&(n=(e||{})[r]);return{parent:e,key:r,value:n}},t.prototype.get=function(t){return this.evaluate(t).value},t.prototype.set=function(t,e){for(var r=t,n=1,s=this.tokens.length-1,i=this.tokens[n];n<s;n++)r=(r||{})[i];r&&(r[this.tokens[this.tokens.length-1]]=e)},t.prototype.push=function(t){this.tokens.push(t)},t.prototype.add=function(e){return new t(this.tokens.concat(String(e)))},t}();e.Pointer=s},99:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.clone=e.objectType=e.hasOwnProperty=void 0,e.hasOwnProperty=Object.prototype.hasOwnProperty,e.objectType=function(t){return void 0===t?"undefined":null===t?"null":Array.isArray(t)?"array":typeof t},e.clone=function t(r){if(null==(n=r)||"object"!=typeof n)return r;var n;if(r.constructor==Array){for(var s=r.length,i=new Array(s),o=0;o<s;o++)i[o]=t(r[o]);return i}if(r.constructor==Date)return new Date(+r);var a={};for(var c in r)e.hasOwnProperty.call(r,c)&&(a[c]=t(r[c]));return a}},4632:function(t,e,r){"use strict";r.d(e,{Z:function(){return n}}),t=r.hmd(t);var n=function(t){var e,r=t.Symbol;return"function"===typeof r?r.observable?e=r.observable:(e=r("observable"),r.observable=e):e="@@observable",e}("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:t)},6131:function(t,e,r){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"===typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(e,{Z:function(){return s}})},9650:function(t,e,r){"use strict";r.d(e,{ZP:function(){return mt}});var n={};r.r(n),r.d(n,{Decoder:function(){return ct},Encoder:function(){return at},PacketType:function(){return ot},protocol:function(){return it}});const s=Object.create(null);s.open="0",s.close="1",s.ping="2",s.pong="3",s.message="4",s.upgrade="5",s.noop="6";const i=Object.create(null);Object.keys(s).forEach((t=>{i[s[t]]=t}));const o={type:"error",data:"parser error"},a="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),c="function"===typeof ArrayBuffer,u=(t,e)=>{const r=new FileReader;return r.onload=function(){const t=r.result.split(",")[1];e("b"+t)},r.readAsDataURL(t)};var l=({type:t,data:e},r,n)=>{return a&&e instanceof Blob?r?n(e):u(e,n):c&&(e instanceof ArrayBuffer||(i=e,"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer))?r?n(e):u(new Blob([e]),n):n(s[t]+(e||""));var i};const h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let vt=0;vt<h.length;vt++)p[h.charCodeAt(vt)]=vt;const f="function"===typeof ArrayBuffer,d=(t,e)=>{if(f){const r=(t=>{let e,r,n,s,i,o=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);const u=new ArrayBuffer(o),l=new Uint8Array(u);for(e=0;e<a;e+=4)r=p[t.charCodeAt(e)],n=p[t.charCodeAt(e+1)],s=p[t.charCodeAt(e+2)],i=p[t.charCodeAt(e+3)],l[c++]=r<<2|n>>4,l[c++]=(15&n)<<4|s>>2,l[c++]=(3&s)<<6|63&i;return u})(t);return y(r,e)}return{base64:!0,data:t}},y=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t;var m=(t,e)=>{if("string"!==typeof t)return{type:"message",data:y(t,e)};const r=t.charAt(0);if("b"===r)return{type:"message",data:d(t.substring(1),e)};return i[r]?t.length>1?{type:i[r],data:t.substring(1)}:{type:i[r]}:o};const g=String.fromCharCode(30);function v(t){if(t)return function(t){for(var e in v.prototype)t[e]=v.prototype[e];return t}(t)}v.prototype.on=v.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},v.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},v.prototype.off=v.prototype.removeListener=v.prototype.removeAllListeners=v.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<n.length;s++)if((r=n[s])===e||r.fn===e){n.splice(s,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},v.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){n=0;for(var s=(r=r.slice(0)).length;n<s;++n)r[n].apply(this,e)}return this},v.prototype.emitReserved=v.prototype.emit,v.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},v.prototype.hasListeners=function(t){return!!this.listeners(t).length};const b="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function w(t,...e){return e.reduce(((e,r)=>(t.hasOwnProperty(r)&&(e[r]=t[r]),e)),{})}const E=setTimeout,P=clearTimeout;function I(t,e){e.useNativeTimers?(t.setTimeoutFn=E.bind(b),t.clearTimeoutFn=P.bind(b)):(t.setTimeoutFn=setTimeout.bind(b),t.clearTimeoutFn=clearTimeout.bind(b))}class _ extends Error{constructor(t,e,r){super(t),this.description=e,this.context=r,this.type="TransportError"}}class O extends v{constructor(t){super(),this.writable=!1,I(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e,r){return super.emitReserved("error",new _(t,e,r)),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=m(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}}const S="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),x={};let A,k=0,D=0;function M(t){let e="";do{e=S[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function N(){const t=M(+new Date);return t!==A?(k=0,A=t):t+"."+M(k++)}for(;D<64;D++)x[S[D]]=D;function C(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}let T=!1;try{T="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(gt){}const j=T;function R(t){const e=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!e||j))return new XMLHttpRequest}catch(r){}if(!e)try{return new(b[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(r){}}function B(){}const L=null!=new R({xdomain:!1}).responseType;class U extends v{constructor(t,e){super(),I(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=w(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new R(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(r){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{e.setRequestHeader("Accept","*/*")}catch(r){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"===typeof e.status?e.status:0)}),0))},e.send(this.data)}catch(r){return void this.setTimeoutFn((()=>{this.onError(r)}),0)}"undefined"!==typeof document&&(this.index=U.requestsCount++,U.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=B,t)try{this.xhr.abort()}catch(e){}"undefined"!==typeof document&&delete U.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(U.requestsCount=0,U.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",G);else if("function"===typeof addEventListener){addEventListener("onpagehide"in b?"pagehide":"unload",G,!1)}function G(){for(let t in U.requests)U.requests.hasOwnProperty(t)&&U.requests[t].abort()}const F="function"===typeof Promise&&"function"===typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),$=b.WebSocket||b.MozWebSocket;r(2241).Buffer;const q="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const V={websocket:class extends O{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,r=q?{}:w(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=q?new $(t,e,r):e?new $(t,e):new $(t)}catch(gt){return this.emitReserved("error",gt)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const r=t[e],n=e===t.length-1;l(r,this.supportsBinary,(t=>{try{this.ws.send(t)}catch(e){}n&&F((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let r="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(r=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=N()),this.supportsBinary||(t.b64=1);const n=C(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}check(){return!!$}},polling:class extends O{constructor(t){if(super(t),this.polling=!1,"undefined"!==typeof location){const e="https:"===location.protocol;let r=location.port;r||(r=e?"443":"80"),this.xd="undefined"!==typeof location&&t.hostname!==location.hostname||r!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=L&&!e}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){((t,e)=>{const r=t.split(g),n=[];for(let s=0;s<r.length;s++){const t=m(r[s],e);if(n.push(t),"error"===t.type)break}return n})(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((t,e)=>{const r=t.length,n=new Array(r);let s=0;t.forEach(((t,i)=>{l(t,!1,(t=>{n[i]=t,++s===r&&e(n.join(g))}))}))})(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let r="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=N()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(r=":"+this.opts.port);const n=C(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new U(this.uri(),t)}doWrite(t,e){const r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)})),this.pollXhr=t}}},z=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,J=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function K(t){const e=t,r=t.indexOf("["),n=t.indexOf("]");-1!=r&&-1!=n&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let s=z.exec(t||""),i={},o=14;for(;o--;)i[J[o]]=s[o]||"";return-1!=r&&-1!=n&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");"/"!=e.substr(0,1)&&0!==e.length||n.splice(0,1);"/"==e.substr(e.length-1,1)&&n.splice(n.length-1,1);return n}(0,i.path),i.queryKey=function(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(r[e]=n)})),r}(0,i.query),i}class H extends v{constructor(t,e={}){super(),t&&"object"===typeof t&&(e=t,t=null),t?(t=K(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=K(e.host).host),I(this,e),this.secure=null!=e.secure?e.secure:"undefined"!==typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"===typeof this.opts.query&&(this.opts.query=function(t){let e={},r=t.split("&");for(let n=0,s=r.length;n<s;n++){let t=r[n].split("=");e[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}return e}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const r=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new V[t](r)}open(){let t;if(this.opts.rememberUpgrade&&H.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(e){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){let e=this.createTransport(t),r=!1;H.priorWebsocketSuccess=!1;const n=()=>{r||(e.send([{type:"ping",data:"probe"}]),e.once("packet",(t=>{if(!r)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;H.priorWebsocketSuccess="websocket"===e.name,this.transport.pause((()=>{r||"closed"!==this.readyState&&(u(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}})))};function s(){r||(r=!0,u(),e.close(),e=null)}const i=t=>{const r=new Error("probe error: "+t);r.transport=e.name,s(),this.emitReserved("upgradeError",r)};function o(){i("transport closed")}function a(){i("socket closed")}function c(t){e&&t.name!==e.name&&s()}const u=()=>{e.removeListener("open",n),e.removeListener("error",i),e.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};e.once("open",n),e.once("error",i),e.once("close",o),this.once("close",a),this.once("upgrading",c),e.open()}onOpen(){if(this.readyState="open",H.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const n=this.writeBuffer[r].data;if(n&&(t+="string"===typeof(e=n)?function(t){let e=0,r=0;for(let n=0,s=t.length;n<s;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}(e):Math.ceil(1.33*(e.byteLength||e.size))),r>0&&t>this.maxPayload)return this.writeBuffer.slice(0,r);t+=2}var e;return this.writeBuffer}write(t,e,r){return this.sendPacket("message",t,e,r),this}send(t,e,r){return this.sendPacket("message",t,e,r),this}sendPacket(t,e,r,n){if("function"===typeof e&&(n=e,e=void 0),"function"===typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;const s={type:t,data:e,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},r=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?r():t()})):this.upgrading?r():t()),this}onError(t){H.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let r=0;const n=t.length;for(;r<n;r++)~this.transports.indexOf(t[r])&&e.push(t[r]);return e}}H.protocol=4;H.protocol;const Y="function"===typeof ArrayBuffer,W=Object.prototype.toString,Z="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===W.call(Blob),X="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===W.call(File);function Q(t){return Y&&(t instanceof ArrayBuffer||(t=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||Z&&t instanceof Blob||X&&t instanceof File}function tt(t,e){if(!t||"object"!==typeof t)return!1;if(Array.isArray(t)){for(let e=0,r=t.length;e<r;e++)if(tt(t[e]))return!0;return!1}if(Q(t))return!0;if(t.toJSON&&"function"===typeof t.toJSON&&1===arguments.length)return tt(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&tt(t[r]))return!0;return!1}function et(t){const e=[],r=t.data,n=t;return n.data=rt(r,e),n.attachments=e.length,{packet:n,buffers:e}}function rt(t,e){if(!t)return t;if(Q(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=rt(t[n],e);return r}if("object"===typeof t&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=rt(t[n],e));return r}return t}function nt(t,e){return t.data=st(t.data,e),t.attachments=void 0,t}function st(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"===typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=st(t[r],e);else if("object"===typeof t)for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=st(t[r],e));return t}const it=5;var ot;!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(ot||(ot={}));class at{constructor(t){this.replacer=t}encode(t){return t.type!==ot.EVENT&&t.type!==ot.ACK||!tt(t)?[this.encodeAsString(t)]:(t.type=t.type===ot.EVENT?ot.BINARY_EVENT:ot.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==ot.BINARY_EVENT&&t.type!==ot.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=et(t),r=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(r),n}}class ct extends v{constructor(t){super(),this.reviver=t}add(t){let e;if("string"===typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t),e.type===ot.BINARY_EVENT||e.type===ot.BINARY_ACK?(this.reconstructor=new ut(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!Q(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const r={type:Number(t.charAt(0))};if(void 0===ot[r.type])throw new Error("unknown packet type "+r.type);if(r.type===ot.BINARY_EVENT||r.type===ot.BINARY_ACK){const n=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const s=t.substring(n,e);if(s!=Number(s)||"-"!==t.charAt(e))throw new Error("Illegal attachments");r.attachments=Number(s)}if("/"===t.charAt(e+1)){const n=e+1;for(;++e;){if(","===t.charAt(e))break;if(e===t.length)break}r.nsp=t.substring(n,e)}else r.nsp="/";const n=t.charAt(e+1);if(""!==n&&Number(n)==n){const n=e+1;for(;++e;){const r=t.charAt(e);if(null==r||Number(r)!=r){--e;break}if(e===t.length)break}r.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=this.tryParse(t.substr(e));if(!ct.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(e){return!1}}static isPayloadValid(t,e){switch(t){case ot.CONNECT:return"object"===typeof e;case ot.DISCONNECT:return void 0===e;case ot.CONNECT_ERROR:return"string"===typeof e||"object"===typeof e;case ot.EVENT:case ot.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case ot.ACK:case ot.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class ut{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=nt(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function lt(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const ht=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class pt extends v{constructor(t,e,r){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,r&&r.auth&&(this.auth=r.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[lt(t,"open",this.onopen.bind(this)),lt(t,"packet",this.onpacket.bind(this)),lt(t,"error",this.onerror.bind(this)),lt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(ht.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const r={type:ot.EVENT,data:e,options:{}};if(r.options.compress=!1!==this.flags.compress,"function"===typeof e[e.length-1]){const t=this.ids++,n=e.pop();this._registerAckCallback(t,n),r.id=t}const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(t,e){const r=this.flags.timeout;if(void 0===r)return void(this.acks[t]=e);const n=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))}),r);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(n),e.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth((t=>{this.packet({type:ot.CONNECT,data:t})})):this.packet({type:ot.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ot.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ot.EVENT:case ot.BINARY_EVENT:this.onevent(t);break;case ot.ACK:case ot.BINARY_ACK:this.onack(t);break;case ot.DISCONNECT:this.ondisconnect();break;case ot.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const r of e)r.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let r=!1;return function(...n){r||(r=!0,e.packet({type:ot.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];"function"===typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t),this.packet(t)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ot.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const r of e)r.apply(this,t.data)}}}function ft(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ft.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-r:t+r}return 0|Math.min(t,this.max)},ft.prototype.reset=function(){this.attempts=0},ft.prototype.setMin=function(t){this.ms=t},ft.prototype.setMax=function(t){this.max=t},ft.prototype.setJitter=function(t){this.jitter=t};class dt extends v{constructor(t,e){var r;super(),this.nsps={},this.subs=[],t&&"object"===typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,I(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=e.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new ft({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const s=e.parser||n;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new H(this.uri,this.opts);const e=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=lt(e,"open",(function(){r.onopen(),t&&t()})),s=lt(e,"error",(e=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",e),t?t(e):r.maybeReconnectOnOpen()}));if(!1!==this._timeout){const t=this._timeout;0===t&&n();const r=this.setTimeoutFn((()=>{n(),e.close(),e.emit("error",new Error("timeout"))}),t);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}return this.subs.push(n),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(lt(t,"ping",this.onping.bind(this)),lt(t,"data",this.ondata.bind(this)),lt(t,"error",this.onerror.bind(this)),lt(t,"close",this.onclose.bind(this)),lt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let r=this.nsps[t];return r||(r=new pt(this,t,e),this.nsps[t]=r),r}_destroy(t){const e=Object.keys(this.nsps);for(const r of e){if(this.nsps[r].active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let r=0;r<e.length;r++)this.engine.write(e[r],t.options)}cleanup(){this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn((()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()})))}),e);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const yt={};function mt(t,e){"object"===typeof t&&(e=t,t=void 0);const r=function(t,e="",r){let n=t;r=r||"undefined"!==typeof location&&location,null==t&&(t=r.protocol+"//"+r.host),"string"===typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?r.protocol+t:r.host+t),/^(https?|wss?):\/\//.test(t)||(t="undefined"!==typeof r?r.protocol+"//"+t:"https://"+t),n=K(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}(t,(e=e||{}).path||"/socket.io"),n=r.source,s=r.id,i=r.path,o=yt[s]&&i in yt[s].nsps;let a;return e.forceNew||e["force new connection"]||!1===e.multiplex||o?a=new dt(n,e):(yt[s]||(yt[s]=new dt(n,e)),a=yt[s]),r.query&&!e.query&&(e.query=r.queryKey),a.socket(r.path,e)}Object.assign(mt,{Manager:dt,Socket:pt,io:mt,connect:mt})}}]);